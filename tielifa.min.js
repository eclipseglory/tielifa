!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WebGL2D=e():(t.tielifa=t.tielifa||{},t.tielifa.WebGL2D=e())}(window,function(){return function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=2*Math.PI,i=void 0,u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=null}return a(t,null,[{key:"equals",value:function(t,e){return Math.abs(t-e)<=1e-5}},{key:"getDistance",value:function(t,e){var n=t.x-e.x,a=t.y-e.y;return Math.sqrt(n*n+a*a)}},{key:"clamp",value:function(t,e,n){return t>n?n:t<e?e:t}},{key:"getInsance",value:function(){return null==this.instance&&(this.instance=new t),this.instance}},{key:"overlaps",value:function(t,e){var n=t,a=e;return n.left<=a.right&&n.right>=a.left&&n.bottom>=a.top&&n.top<=a.bottom}},{key:"isHit",value:function(e,n){var a=!1,r=e.left,i=e.top;return t.isInTheRect(r,i,n)&&(a=!0),r=e.left,i=e.top+e.height,t.isInTheRect(r,i,n)&&(a=!0),r=e.left+e.width,i=e.top,t.isInTheRect(r,i,n)&&(a=!0),r=e.left+e.width,i=e.top+e.height,t.isInTheRect(r,i,n)&&(a=!0),a||(r=n.left,i=n.top,t.isInTheRect(r,i,e)&&(a=!0),r=n.left,i=n.top+n.height,t.isInTheRect(r,i,e)&&(a=!0),r=n.left+n.width,i=n.top,t.isInTheRect(r,i,e)&&(a=!0),r=n.left+n.width,i=n.top+n.height,t.isInTheRect(r,i,e)&&(a=!0)),a}},{key:"isInTheRect",value:function(t,e,n){var a=n.left,r=n.top,i=n.width,u=n.height;return t>a&&t<a+i&&e>r&&e<r+u}},{key:"PI2",get:function(){return r}},{key:"EPSILON",get:function(){return 1e-5}},{key:"littleEndian",get:function(){if(void 0===i){var t=new ArrayBuffer(2),e=new Uint8Array(t),n=new Uint16Array(t);e[0]=170,e[1]=187,48042===n[0]&&(i=!0),43707===n[0]&&(i=!1)}return i}}]),t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(0),u=(a=i)&&a.__esModule?a:{default:a};var o=void 0,s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"perspective2",value:function(t,e,n,a,r,i){return[2*r/(n-t),0,0,0,0,2*r/(e-a),0,0,(n+t)/(n-t),(a+e)/(e-a),(-r-i)/(i-r),-1,0,0,-r*i*2/(i-r),0]}},{key:"perspective3",value:function(e,n,a,r,i,u){var o=this.perspective(e,n/a,r,i,u),s=t.TEMP_MAT4[0];return t.translationMatrix(s,-n/2,-a/2,0),t.multiply(o,o,s),o}},{key:"perspective",value:function(t,e,n,a,r){var i=Math.tan(.5*Math.PI-.5*t);u.default.equals(i,1)&&(i=1);var o=1/(n-a),s=void 0;return null!=r?(this.identityMatrix(r),s=r):s=this.identity(),s[0]=i/e,s[5]=-i,s[10]=(n+a)*o,s[11]=-1,s[14]=n*a*o*2,s}},{key:"orthoProjection",value:function(t,e,n,a,r,i,u){return null!=u?(this.identityMatrix(u),u[0]=2/(n-t),u[5]=2/(e-a),u[10]=2/(r-i),u[12]=(t+n)/(t-n),u[13]=(a+e)/(a-e),u[14]=(r+i)/(r-i),u):new Float32Array([2/(n-t),0,0,0,0,2/(e-a),0,0,0,0,2/(r-i),0,(t+n)/(t-n),(a+e)/(a-e),(r+i)/(r-i),1])}},{key:"copy",value:function(t,e){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}},{key:"equals",value:function(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],o=t[4],s=t[5],l=t[6],h=t[7],f=t[8],c=t[9],d=t[10],y=t[11],v=t[12],g=t[13],x=t[14],b=t[15],m=e[0],p=e[1],k=e[2],M=e[3],P=e[4],w=e[5],T=e[6],S=e[7],_=e[8],I=e[9],A=e[10],E=e[11],C=e[12],D=e[13],L=e[14],O=e[15];return Math.abs(n-m)<=u.default.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-p)<=u.default.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(r-k)<=u.default.EPSILON*Math.max(1,Math.abs(r),Math.abs(k))&&Math.abs(i-M)<=u.default.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(o-P)<=u.default.EPSILON*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(s-w)<=u.default.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-T)<=u.default.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(h-S)<=u.default.EPSILON.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-_)<=u.default.EPSILON*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(c-I)<=u.default.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-A)<=u.default.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(y-E)<=u.default.EPSILON*Math.max(1,Math.abs(y),Math.abs(E))&&Math.abs(v-C)<=u.default.EPSILON*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(g-D)<=u.default.EPSILON*Math.max(1,Math.abs(g),Math.abs(D))&&Math.abs(x-L)<=u.default.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(b-O)<=u.default.EPSILON*Math.max(1,Math.abs(b),Math.abs(O))}},{key:"exactEquals",value:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}},{key:"projection",value:function(t,e,n){var a=this.identity();return a[0]=2/t,a[5]=-2/e,a[10]=2/n,a[12]=-1,a[13]=1,a[15]=1,a}},{key:"identity",value:function(){var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}},{key:"identityMatrix",value:function(t){var e=t;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}},{key:"translationMatrix",value:function(t,e,n,a){var r=t;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e,r[13]=n,r[14]=a,r[15]=1}},{key:"translation",value:function(t,e,n){var a=this.identity();return a[12]=t,a[13]=e,a[14]=n,a}},{key:"rotationZMatrix",value:function(t,e){var n=t;n[2]=0,n[3]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1;var a=Math.cos(e),r=Math.sin(e);n[0]=a,n[1]=r,n[4]=-r,n[5]=a}},{key:"rotationZ",value:function(t){var e=Math.cos(t),n=Math.sin(t),a=this.identity();return a[0]=e,a[1]=n,a[4]=-n,a[5]=e,a}},{key:"rotationXMatrix",value:function(t,e){var n=t;n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[7]=0,n[8]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1;var a=Math.cos(e),r=Math.sin(e);n[5]=a,n[6]=r,n[9]=-r,n[10]=a}},{key:"rotationX",value:function(t){var e=Math.cos(t),n=Math.sin(t),a=this.identity();return a[5]=e,a[6]=n,a[9]=-n,a[10]=e,a}},{key:"rotationYMatrix",value:function(t,e){var n=t;n[1]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1;var a=Math.cos(e),r=Math.sin(e);n[0]=a,n[2]=-r,n[8]=r,n[10]=a}},{key:"rotationY",value:function(t){var e=Math.cos(t),n=Math.sin(t),a=this.identity();return a[0]=e,a[2]=-n,a[8]=n,a[10]=e,a}},{key:"scalingMatrix",value:function(t,e,n,a){var r=t;r[0]=e,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1}},{key:"scaling",value:function(t,e,n){var a=this.identity();return a[0]=t,a[5]=e,a[10]=n,a}},{key:"multiplyWithVertex",value:function(t,e,n){var a=t[0],r=t[1],i=t[2],u=t[3],o=t[4],s=t[5],l=t[6],h=t[7],f=t[8],c=t[9],d=t[10],y=t[11],v=t[12],g=t[13],x=t[14],b=t[15],m=e[0],p=e[1],k=e[2],M=e[3];return null==k&&(k=0),null==M&&(M=1),n[0]=m*a+p*o+k*f+M*v,n[1]=m*r+p*s+k*c+M*g,n[2]=m*i+p*l+k*d+M*x,n[3]=m*u+p*h+k*y+M*b,n}},{key:"multiply",value:function(t,e,n){var a=e[0],r=e[1],i=e[2],u=e[3],o=e[4],s=e[5],l=e[6],h=e[7],f=e[8],c=e[9],d=e[10],y=e[11],v=e[12],g=e[13],x=e[14],b=e[15],m=n[0],p=n[1],k=n[2],M=n[3];return t[0]=m*a+p*o+k*f+M*v,t[1]=m*r+p*s+k*c+M*g,t[2]=m*i+p*l+k*d+M*x,t[3]=m*u+p*h+k*y+M*b,m=n[4],p=n[5],k=n[6],M=n[7],t[4]=m*a+p*o+k*f+M*v,t[5]=m*r+p*s+k*c+M*g,t[6]=m*i+p*l+k*d+M*x,t[7]=m*u+p*h+k*y+M*b,m=n[8],p=n[9],k=n[10],M=n[11],t[8]=m*a+p*o+k*f+M*v,t[9]=m*r+p*s+k*c+M*g,t[10]=m*i+p*l+k*d+M*x,t[11]=m*u+p*h+k*y+M*b,m=n[12],p=n[13],k=n[14],M=n[15],t[12]=m*a+p*o+k*f+M*v,t[13]=m*r+p*s+k*c+M*g,t[14]=m*i+p*l+k*d+M*x,t[15]=m*u+p*h+k*y+M*b,t}},{key:"inverse",value:function(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],u=e[4],o=e[5],s=e[6],l=e[7],h=e[8],f=e[9],c=e[10],d=e[11],y=e[12],v=e[13],g=e[14],x=e[15],b=n*o-a*u,m=n*s-r*u,p=n*l-i*u,k=a*s-r*o,M=a*l-i*o,P=r*l-i*s,w=h*v-f*y,T=h*g-c*y,S=h*x-d*y,_=f*g-c*v,I=f*x-d*v,A=c*x-d*g,E=b*A-m*I+p*_+k*S-M*T+P*w;return E?(E=1/E,t[0]=(o*A-s*I+l*_)*E,t[1]=(r*I-a*A-i*_)*E,t[2]=(v*P-g*M+x*k)*E,t[3]=(c*M-f*P-d*k)*E,t[4]=(s*S-u*A-l*T)*E,t[5]=(n*A-r*S+i*T)*E,t[6]=(g*p-y*P-x*m)*E,t[7]=(h*P-c*p+d*m)*E,t[8]=(u*I-o*S+l*w)*E,t[9]=(a*S-n*I-i*w)*E,t[10]=(y*M-v*p+x*b)*E,t[11]=(f*p-h*M-d*b)*E,t[12]=(o*T-u*_-s*w)*E,t[13]=(n*_-a*T+r*w)*E,t[14]=(v*m-y*k-g*b)*E,t[15]=(h*k-f*m+c*b)*E,t):null}},{key:"TEMP_MAT4",get:function(){return null==o&&(o=[t.identity(),t.identity(),t.identity(),t.identity()]),o}},{key:"EPSILON",get:function(){return u.default.EPSILON}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(0),u=(a=i)&&a.__esModule?a:{default:a};var o=void 0,s=function(){function t(e,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=new Float32Array(4),this.x=e||0,this.y=n||0,this.z=a||0,this.value[3]=1}return r(t,[{key:"x",get:function(){return this.value[0]},set:function(t){this.value[0]=t}},{key:"y",get:function(){return this.value[1]},set:function(t){this.value[1]=t}},{key:"z",get:function(){return this.value[2]},set:function(t){this.value[2]=t}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}}],[{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"normalize",value:function(t,e){var n=e.magnitude;u.default.equals(0,n)?(t.x=0,t.y=0,t.z=0):(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n)}},{key:"plus",value:function(t,e,n){return t.x=e.x+n.x,t.y=e.y+n.y,t.z=e.z+n.z,t}},{key:"multiplyValue",value:function(t,e,n){return t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t}},{key:"copy",value:function(t,e){e.x=t.x,e.y=t.y,e.z=t.z}},{key:"cross",value:function(t,e,n){return t.x=e.y*n.z-e.z*n.y,t.y=e.z*n.x-e.x*n.z,t.z=e.x*n.y-e.y*n.x,t}},{key:"TEMP_VECTORS",get:function(){return null==o&&(o=[new t,new t,new t,new t]),o}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=o(n(2)),i=o(n(18)),u=o(n(4));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return a(t,null,[{key:"getProjectionPointOnLine",value:function(t,e,n){var a=u.default.TEMP_VECTORS[0];a.x=n.x-e.x,a.y=n.y-e.y,u.default.normalize(a,a);var r=u.default.TEMP_VECTORS[1];r.x=t.x-e.x,r.y=t.y-e.y;var i=u.default.dot(r,a);u.default.multiplyValue(a,a,i);var o={x:0,y:0};return u.default.plus(o,a,e),o}},{key:"cubicBezier",value:function(t,e,n,a,r,i,u,o,s,l){var h=1-t,f=h*h*h*e;f+=3*h*h*t*a,f+=3*h*t*t*i,f+=t*t*t*o;var c=h*h*h*n;return c+=3*h*h*t*r,c+=3*h*t*t*u,c+=t*t*t*s,(l=l||[0,0])[0]=f,l[1]=c,l}},{key:"quadraticBezier",value:function(t,e,n,a,r,i,u,o){var s=1-t,l=s*s*e;l+=2*s*t*a,l+=t*t*i,(o=o||[0,0])[0]=l;var h=s*s*n;return h+=2*s*t*r,h+=t*t*u,o[1]=h,o}},{key:"arcConversionEndpointToCenter",value:function(t,e,n,a,r,o,s){var l=[(t-n)/2,(e-a)/2,1],h=i.default.TEMP_MAT3[0];0!=s&&(i.default.rotate(h,-s),i.default.multiplyWithVertex(h,h,l),l[0]=h[0],l[1]=h[1]);var f=r*r*o*o/(r*r*l[1]*l[1]+o*o*l[0]*l[0]);if((f=Math.abs(f-1))<0)throw new Error("radius is small, the ellipse does not across these two points");var c=Math.sqrt(f),d=1;c*=d;var y=[r*l[1]/o,-o*l[0]/r,0];y[0]*=c,y[1]*=c;var v=[y[0],y[1],1];0!=s&&(i.default.rotate(h,s),i.default.multiplyWithVertex(h,h,v));var g=v[0]+(t+n)/2,x=v[1]+(e+a)/2,b=u.default.TEMP_VECTORS[0];b.x=1,b.y=0;var m=u.default.TEMP_VECTORS[1];m.x=(l[0]-y[0])/r,m.y=(l[1]-y[1])/o;var p=Math.abs(Math.acos(u.default.dot(b,m)/(b.magnitude*m.magnitude)));b.x*m.y<0&&(p*=-1),b.x=(-l[0]-y[0])/r,b.y=(-l[1]-y[1])/o;var k=Math.acos(u.default.dot(b,m)/(b.magnitude*m.magnitude));return{x:g,y:x,theta:p,deltaTheta:k=Math.abs(k%(2*Math.PI))}}},{key:"getEllipsePointWithRadian",value:function(t,e,n,a,u,o,s){s=s||[0,0];var l=r.default.TEMP_VECTORS[0];if(l.x=n*Math.cos(u),l.y=a*Math.sin(u),l.z=0,0!=o){var h=i.default.TEMP_MAT3[0];i.default.rotate(h,o),i.default.multiplyWithVertex(h,h,l.value),l.x=h[0],l.y=h[1]}return s[0]=l.x+t,s[1]=l.y+e,s}},{key:"calculateIntersectionOfPlane",value:function(t,e,n,a,i,u){var o=r.default.dot(t,e);if(0==o)return null;var s=r.default.TEMP_VECTORS[0];s.x=a.x-n.x,s.y=a.y-n.y,s.z=a.z-n.z;var l=r.default.dot(s,t)/o;null!=u&&l>u&&(l=u),r.default.multiplyValue(s,e,l),r.default.plus(i,s,n)}},{key:"calculateIntersectionOfTowLines",value:function(t,e,n,a){var r=t.x,i=t.y,u=e.x,o=e.y,s=n.x,l=n.y,h=a.x,f=a.y,c=(r-u)*(l-f)-(i-o)*(s-h);if(0!=c){var d=(r*o-i*u)*(s-h)-(r-u)*(s*f-l*h),y=(r*o-i*u)*(l-f)-(i-o)*(s*f-l*h);return{x:d/=c,y:y/=c}}}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(0),u=(a=i)&&a.__esModule?a:{default:a};var o=Symbol("二维向量值数组,0是x，1是y"),s=void 0,l=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this[o]=new Float32Array(3),null==e&&null==e||(this.x=e),null==n&&null==n||(this.y=n),this[o][2]=1}return r(t,[{key:"x",get:function(){return this[o][0]},set:function(t){this[o][0]=t}},{key:"y",get:function(){return this[o][1]},set:function(t){this[o][1]=t}},{key:"value",get:function(){return this[o]},set:function(t){this[o][0]=t[0],this[o][1]=t[1]}},{key:"radian",get:function(){return Math.atan2(this.y,this.x)}},{key:"magnitude",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}}],[{key:"rotate",value:function(t,e,n){var a=Math.cos(n),r=Math.sin(n);return t||(t={}),t.y=e.x*r+e.y*a,t.x=e.x*a-e.y*r,t}},{key:"rotateAbout",value:function(t,e,n,a){var r=Math.cos(a),i=Math.sin(a);return t||(t={}),t.x=n.x+((e.x-n.x)*r-(e.y-n.y)*i),t.y=n.y+((e.x-n.x)*i+(e.y-n.y)*r),t}},{key:"normalize",value:function(t,e){var n=e.magnitude;return null==t?t=e.clone():t!=e&&(t.x=e.x,t.y=e.y),0==n?(t.x=0,t.y=0,t):(t.x=t.x/n,t.y=t.y/n,t)}},{key:"multiplyValue",value:function(t,e,n){var a=e.x*n,r=e.y*n;t.x=a,t.y=r}},{key:"dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"cross",value:function(t,e){return t.x*e.y-t.y*e.x}},{key:"crossZ",value:function(t,e,n){return t.x=e.y*n,t.y=-e.x*n,t}},{key:"zCrossVector",value:function(t,e,n){return t.x=-e*n.y,t.y=e*n.x,t}},{key:"plus",value:function(t,e,n){return t.x=e.x+n.x,t.y=e.y+n.y,t}},{key:"sub",value:function(t,e,n){return t.x=e.x-n.x,t.y=e.y-n.y,t}},{key:"TEMP_VECTORS",get:function(){return null==s&&(s=[new t(0,0),new t(0,0),new t(0,0),new t(0,0)]),s}}]),r(t,[{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"subtract",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"multiply",value:function(t){return this.x*=t,this.y*=t,this}},{key:"split",value:function(e,n){var a=Math.max(e,n),r=Math.min(e,n);console.log(a,r);var i=Math.PI-(a-r),u=this.magnitude/Math.sin(i),o=a-this.radian,s=Math.PI-o-i,l=u*Math.sin(s),h=u*Math.sin(o),f=t.createVector(h,r),c=t.createVector(l,a);f.add(c)}},{key:"splitWithRightAngle",value:function(e){this.rotate(-e);var n=new t(this.x,0),a=new t(0,this.y);return n.rotate(e),a.rotate(e),this.rotate(e),{hVector:n,vVector:a}}},{key:"reverse",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"rotate",value:function(t){var e=this.radian+t,n=this.magnitude;this.x=Math.abs(n)*Math.cos(e),this.y=Math.abs(n)*Math.sin(e)}},{key:"clone",value:function(){return new t(this.x,this.y)}}],[{key:"createVector",value:function(e,n){var a=Math.abs(e)*Math.cos(n);Math.abs(a)<u.default.EPSILON&&(a=0);var r=Math.abs(e)*Math.sin(n);return Math.abs(r)<u.default.EPSILON&&(r=0),new t(a,r)}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=void 0,i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.singleDataByteLength=n,this.buffer=new ArrayBuffer(e*n),this.dv=new DataView(this.buffer),this.currentIndex=0,this.isLittleEndian=t.littleEndian()}return a(t,[{key:"init",value:function(){this.currentIndex=0}},{key:"getData",value:function(t,e,n){t*=this.singleDataByteLength,null==e&&(e=4),null==n&&(n=0),t+=n;var a=this.isLittleEndian;switch(e){case 8:return this.dv.getFloat64(t,a);case 1:return this.dv.getUint8(t);case 5:return this.dv.getInt8(t);case 2:return this.dv.getUint8(t);case 6:return this.dv.getInt16(t,a);case 3:return this.dv.getUint16(t,a);case 4:return this.dv.getFloat32(t,a);case 7:return this.dv.getInt32(t,a);case 0:return this.dv.getUint32(t,a)}}},{key:"setData",value:function(t,e,n,a){var r=this.isLittleEndian;switch(null==a&&(a=0),null==n&&(n=4),e*=this.singleDataByteLength,e+=a,n){case 8:this.dv.setFloat64(e,t,r);break;case 1:this.dv.setUint8(e,t);break;case 5:this.dv.setInt8(e,t);break;case 2:this.dv.setUint8(e,t);break;case 6:this.dv.setInt16(e,t,r);break;case 3:this.dv.setUint16(e,t,r);break;case 4:this.dv.setFloat32(e,t,r);break;case 7:this.dv.setInt32(e,t,r);break;case 0:this.dv.setUint32(e,t,r)}}},{key:"resize",value:function(t){if(t<this.totalByteLength)throw Error("new length should not less than old length");var e=this.buffer;this.buffer=new ArrayBuffer(t);var n=new Uint8Array(e);new Uint8Array(this.buffer).set(n,0),this.dv=new DataView(this.buffer)}},{key:"totalByteLength",get:function(){return this.buffer.byteLength}}],[{key:"littleEndian",value:function(){if(null==r){var t=new ArrayBuffer(2),e=new Uint8Array(t),n=new Uint16Array(t);return e[0]=170,e[1]=187,48042===n[0]&&(r=!0),43707===n[0]&&(r=!1),r}return r}},{key:"TYPE_FLOAT32",get:function(){return 4}},{key:"TYPE_FLOAT64",get:function(){return 8}},{key:"TYPE_UINT8",get:function(){return 2}},{key:"TYPE_UINT16",get:function(){return 3}},{key:"TYPE_UINT32",get:function(){return 0}},{key:"TYPE_INT8",get:function(){return 5}},{key:"TYPE_INT16",get:function(){return 6}},{key:"TYPE_INT32",get:function(){return 7}},{key:"TYPE_UINT8CLAMPED",get:function(){return 1}}]),t}();e.default=i},function(t,e,n){t.exports=n(7)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=m(n(8)),i=m(n(9)),u=m(n(10)),o=m(n(11)),s=m(n(12)),l=m(n(14)),h=m(n(19)),f=m(n(0)),c=m(n(1)),d=m(n(22)),y=m(n(23)),v=m(n(24)),g=m(n(2)),x=m(n(3)),b=m(n(4));function m(t){return t&&t.__esModule?t:{default:t}}var p=Symbol("对应的Canvas"),k=Symbol("状态栈"),M=Symbol("状态数组，记录全部状态"),P=Symbol("路径列表"),w=Symbol("绘制动作List"),T=Symbol("子Path缓存"),S=new Float32Array(4),_=new Float32Array(4),I=[new Float32Array(4),new Float32Array(4),new Float32Array(4),new Float32Array(4)],A=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null!=n&&null!=n||(n=[]);for(var a=0;a<I.length;a++)I[a][3]=1;if(S[2]=1,S[3]=1,_[3]=1,this[p]=e,null==e||null==e)throw new Error("canvas can not be undefined or null");if(this.gl=e.getContext("webgl"),null==this.gl)throw new Error("Current canvas doesnt support WebGL");var r=n.FOV||20;this.maxBufferByteLength=n.maxMemorySize||1048576,this[k]=[],this[M]=[],this[P]=[],this[w]=[],this[T]=[],this.webglRender=new h.default(this.gl,n.maxTransformNum,n.maxTextureSize,n.projectionType,r);var i=this.maxBufferByteLength/32;this.verticesData=new d.default(i),this.fragmetData=new y.default(i),this.transformMatrixData=new v.default(i),this.webglRender.verticesData=this.verticesData,this.webglRender.fragmentData=this.fragmetData,this.webglRender.transformMatrixData=this.transformMatrixData,this.currentFaceNormal=new Float32Array(4),this.currentFaceNormal[2]=1}return a(t,[{key:"clean",value:function(){this[P].length=0,this.webglRender.clean()}},{key:"clearRect",value:function(t,e,n,a){this.clean()}},{key:"beginPath",value:function(){this.currentPath.clean()}},{key:"closePath",value:function(){var t=this.currentPath;if(0!=t.subPathNumber){var e=t.lastSubPath;e.close();var n=e.getPointX(0),a=e.getPointX(0),r=e.getPointX(0),i=e.getPointStateId(0),u=e.getPointMatrixId(0),s=new o.default;s.addPoint(n,a,r,i,u),t.addSubPath(s)}}},{key:"lineTo",value:function(t,e,n){null==n&&(n=0);var a=this.currentPath;if(null==a.lastSubPath){var r=new o.default;return a.addSubPath(r),void this.addPointInLastSubPath(t,e,n,!0)}this.addPointInLastSubPath(t,e,n,!0)}},{key:"addPointInPath",value:function(t,e,n,a,r){var i=this.currentContextState,u=i.transformMatrix.matrix;if(r){var o=I[0];o[0]=t,o[1]=e,o[2]=n,o[3]=1,c.default.multiplyWithVertex(u,o,o),t=o[0],e=o[1],n=o[2],i.fireDirty()}a.addPoint(t,e,n,i.id,i.transformMatrixId)}},{key:"addPointInLastSubPath",value:function(t,e,n,a){this.addPointInPath(t,e,n,this.currentPath.lastSubPath,a)}},{key:"moveTo",value:function(t,e,n){null==n&&(n=0);var a=this.currentContextState,r=this.currentPath,i=r.lastSubPath;if(null!=i&&i.pointsNumber<2){var u=a.transformMatrix.matrix,s=I[0];s[0]=t,s[1]=e,s[2]=n,s[3]=1;var l=c.default.multiplyWithVertex(u,s,s);i.setPoint(0,l[0],l[1],l[2],a.id,a.transformMatrixId)}else{var h=new o.default;r.addSubPath(h),this.addPointInLastSubPath(t,e,n,!0)}}},{key:"rect",value:function(t,e,n,a,r){null==r&&(r=0),this.moveTo(t,e,r),this.lineTo(t+n,e,r),this.lineTo(t+n,e+a,r),this.lineTo(t,e+a,r),this.closePath()}},{key:"bezierCurveTo",value:function(t,e,n,a,r,i){var u,o=t,s=e,l=this.currentPath,h=this.currentContextState,f=l.lastSubPath,d=I[0];d[0]=t,d[1]=e,d[2]=0,d[3]=1;var y=this.currentContextState.transformMatrix.matrix;c.default.multiplyWithVertex(y,d,d),t=d[0],e=d[1],u=d[2],d[0]=n,d[1]=a,d[2]=0,d[3]=1,c.default.multiplyWithVertex(y,d,d),n=d[0],a=d[1],d[0]=r,d[1]=i,d[2]=0,d[3]=1,c.default.multiplyWithVertex(y,d,d),r=d[0],i=d[1];var v=t,g=e;if(null==f)this.moveTo(o,s);else{var b=f.pointsNumber-1,m=f.getPointX(b),p=f.getPointY(b);m!=t&&p!=e&&(v=m,g=p)}for(var k=6*(r-3*n+3*t-v),M=6*(i-3*a+3*e-g),P=1/(k*k+M*M),w=Math.pow(P,1/6),T=I[0],S=w;S<1;S+=w)x.default.cubicBezier(S,v,g,t,e,n,a,r,i,T),this.addPointInLastSubPath(T[0],T[1],u,!1);S>1&&1!=S&&this.addPointInLastSubPath(r,i,u,!1),h.fireDirty()}},{key:"quadraticCurveTo",value:function(t,e,n,a){var r=this.currentPath,i=this.currentContextState,u=r.lastSubPath,s=I[0];s[0]=t,s[1]=e,s[2]=0,s[3]=1;var l=this.currentContextState.transformMatrix.matrix;c.default.multiplyWithVertex(l,s,s),t=s[0],e=s[1];var h=s[2];s[0]=n,s[1]=a,s[2]=0,s[3]=1,c.default.multiplyWithVertex(l,s,s),n=s[0],a=s[1];var f=s[2],d=t,y=e;if(null==u){var v=new o.default;r.addSubPath(v),this.addPointInLastSubPath(t,e,h,!1)}else{var g=u.pointsNumber-1,b=u.getPointX(g),m=u.getPointY(g);b!=t&&m!=e&&(d=b,y=m)}if(d!=t||y!=e){for(var p=2*(n-2*t+d),k=2*(a-2*e+y),M=1/(p*p+k*k),P=Math.pow(M,.25),w=I[0],T=P;T<=1;T+=P)x.default.quadraticBezier(T,d,y,t,e,n,a,w),this.addPointInLastSubPath(w[0],w[1],h,!1);this.addPointInLastSubPath(n,a,f,!1),i.fireDirty()}else this.addPointInLastSubPath(n,a,f,!1)}},{key:"arcTo",value:function(t,e,n,a,r){if(r<0)throw new Error("IndexError: Radius value wrong");var i=this.currentPath.lastSubPath,u=0,s=0;if(null==i)return i=new o.default,this.currentPath.addSubPath(i),void this.moveTo(t,e);var l=i.getPointX(i.pointsNumber-1),h=i.getPointY(i.pointsNumber-1),d=i.getPointZ(i.pointsNumber-1),y=I[0];y[0]=l,y[1]=h,y[2]=d,y[3]=1;var v=this.currentContextState.transformMatrix.matrix,g=c.default.TEMP_MAT4[0];if(c.default.copy(v,g),c.default.inverse(g,g),c.default.multiplyWithVertex(g,y,y),f.default.equals(l,t)&&f.default.equals(h,e)||f.default.equals(t,n)&&f.default.equals(e,a)||0==r)this.lineTo(t,e);else{u=y[0],s=y[1];var m=new b.default(u-t,s-e),p=new b.default(n-t,a-e);b.default.normalize(m,m),b.default.normalize(p,p);var k=new b.default;b.default.plus(k,m,p),b.default.normalize(k,k);var M=Math.acos(b.default.dot(m,k));if(f.default.equals(2*M%Math.PI,0))this.lineTo(t,e);else{var P=r/Math.sin(M),w=k.x*P+t,T=k.y*P+e,S={x:w,y:T},_={x:t,y:e},A={x:u,y:s},E={x:n,y:a},C=x.default.getProjectionPointOnLine(S,_,A),D=x.default.getProjectionPointOnLine(S,_,E),L=new b.default(C.x-w,C.y-T),O=new b.default(D.x-w,D.y-T);b.default.normalize(L,L),b.default.normalize(O,O);var R=Math.atan2(L.y,L.x),N=R;N=F(N);var B=Math.atan2(O.y,O.x),z=B;z=F(z);var V=!1;Math.abs(N-z)>Math.PI&&(V=!0),this.arc(w,T,r,R,B,V)}}function F(t){var e=2*Math.PI,n=Math.floor(Math.abs(t/e));return t<0&&(t+=n*e),t>=e&&(t-=n*e),t}}},{key:"ellipse",value:function(t,e,n,a,r,i,u,s){if(n<0||a<0)throw new Error("IndexError.半径必须不小于0. Radius should not be smaller than zero. BanJing BiXu BuXiaoYu Ling");if(0!=n&&0!=a){null==s&&(s=!1);var l=this.currentPath.lastSubPath;null==l&&(l=new o.default,this.currentPath.addSubPath(l));var h=c.default.TEMP_MAT4[0];c.default.translationMatrix(h,t,e,0);var d=this.currentContextState.transformMatrix.matrix;c.default.multiply(h,d,h);var y=c.default.TEMP_MAT4[1];c.default.rotationZMatrix(y,r),c.default.multiply(h,h,y),c.default.identityMatrix(y),y[0]=n,y[5]=a,c.default.multiply(h,h,y);var v=I[0];v[0]=0,v[1]=0,v[2]=0,v[3]=1,c.default.multiplyWithVertex(d,v,v);var x=v[0],b=v[1];v[0]=1,v[1]=0,v[2]=0,v[3]=1,c.default.multiplyWithVertex(d,v,v);var m=v[0],p=v[1],k=(m-x)*(m-x)+(p-b)*(p-b);k=Math.sqrt(k);var M=Math.max(n*k,a*k),P=2*Math.asin(1/M),w=new g.default;if(((i=O(i))>(u=O(u))&&!s||i<u&&s)&&((i<0||u<0)&&((u-=2*Math.PI)==i||Math.abs(u-i)<=f.default.EPSILON)&&(u-=2*Math.PI),(i>0||u>0)&&((u+=2*Math.PI)==i||Math.abs(u-i)<=f.default.EPSILON)&&(u+=2*Math.PI)),s)for(var T=i;T>u;T-=P){if(Math.abs(T-i)>=f.default.PI2)return;var S=Math.sin(T),_=Math.cos(T);w.x=_,w.y=S,w.z=0,c.default.multiplyWithVertex(h,w.value,w.value),this.addPointInLastSubPath(w.x,w.y,w.z,!1)}else for(var A=i;A<u;A+=P){if(Math.abs(A-i)>=f.default.PI2)return;var E=Math.sin(A),C=Math.cos(A);w.x=C,w.y=E,w.z=0,c.default.multiplyWithVertex(h,w.value,w.value),this.addPointInLastSubPath(w.x,w.y,w.z,!1)}var D=Math.sin(u),L=Math.cos(u);w.x=L,w.y=D,w.z=0,c.default.multiplyWithVertex(h,w.value,w.value),this.addPointInLastSubPath(w.x,w.y,w.z,!1)}function O(t){var e=2*Math.PI,n=Math.floor(Math.abs(t/e))+1;return t<0&&!s&&(t+=n*e),t>0&&s&&(t-=n*e),t}}},{key:"arc",value:function(t,e,n,a,r,i){this.ellipse(t,e,n,n,0,a,r,i)}},{key:"save",value:function(){var t=this.currentContextState.clone();this[k].push(t),t.id=this[M].length-1}},{key:"restore",value:function(){0!=this[k].length&&this[k].pop()}},{key:"translate",value:function(t,e,n){this.currentContextState.translate(t,e,n)}},{key:"rotate",value:function(t){this.currentContextState.rotateZ(t)}},{key:"rotateX",value:function(t){this.currentContextState.rotateX(t)}},{key:"rotateY",value:function(t){this.currentContextState.rotateY(t)}},{key:"scale",value:function(t,e,n){this.currentContextState.scale(t,e,n)}},{key:"setTransform",value:function(t,e,n,a,r,i){c.default.identityMatrix(this.currentContextState.transformMatrix.matrix);var u=this.currentContextState.transformMatrix.matrix;u[0]=t,u[1]=e,u[4]=n,u[5]=a,u[12]=r,u[13]=i,u[14]=0}},{key:"transform",value:function(t,e,n,a,r,i){var u=c.default.TEMP_MAT4[0];c.default.identityMatrix(u),u[0]=t,u[1]=e,u[4]=n,u[5]=a,u[12]=r,u[13]=i,this.currentContextState.applyTransform(u)}},{key:"drawImage",value:function(t,e,n,a,r,i,u,o,s,h){h=h||0;var f=this.webglRender.textureManager.getTexture(t,this.gl,!0),c=new l.default(l.default.ACTION_FILL);c.textureIndex=f.index;var d=void 0,y=void 0,v=void 0,g=void 0,x=void 0,b=void 0,m=void 0,p=void 0;3==arguments.length&&(d=e,y=n,v=e+t.width,g=n+t.height,x=f.x,m=f.x+f.width,b=f.y,p=f.y+f.height),4==arguments.length&&(d=e,y=n,v=e+t.width,g=n+t.height,x=f.x,m=f.x+f.width,b=f.y,p=f.y+f.height,h=a),5==arguments.length&&(d=e,y=n,v=e+a,g=n+r,x=f.x,m=f.x+f.width,b=f.y,p=f.y+f.height),6==arguments.length&&(d=e,y=n,v=e+a,g=n+r,x=f.x,m=f.x+f.width,b=f.y,p=f.y+f.height,h=i),9!=arguments.length&&10!=arguments.length||(d=i,y=u,v=i+o,g=u+s,x=f.x+e,m=f.x+e+a,b=f.y+n,p=f.y+n+r),this.beginPath(),this.rect(d,y,v-d,g-y,h);var k=this.currentContextState.globalAlpha,M=this[P];this[w].push(c);var T=new Array(4);T[0]=[x,b],T[1]=[m,b],T[2]=[m,p],T[3]=[x,p];c.verticesData=this.verticesData,c.fragmentData=this.fragmetData,c.collectVertexDataForFill(M,[255,255,255],k,T,this.currentFaceVector)}},{key:"fill",value:function(){var t=s.default.getInstance().convertStringToColor(this.currentContextState.fillStyle),e=this.currentContextState.globalAlpha,n=this[P],a=new l.default(l.default.ACTION_FILL);a.verticesData=this.verticesData,a.fragmentData=this.fragmetData,this[w].push(a),a.collectVertexDataForFill(n,t,e*t[3],[0,0],this.currentFaceVector)}},{key:"fillRect",value:function(t,e,n,a){this.beginPath(),this.rect(t,e,n,a),this.fill()}},{key:"stroke2",value:function(){var t=s.default.getInstance().convertStringToColor(this.currentContextState.strokeStyle),e=this.currentContextState.globalAlpha,n=this[P],a=new l.default(l.default.ACTION_STROKE);this[w].push(a),a.collectVertexData(n,t,e*t[3],[0,0])}},{key:"stroke",value:function(){var t=s.default.getInstance().convertStringToColor(this.currentContextState.strokeStyle),e=this.currentContextState.globalAlpha,n=this[P],a=this.currentContextState.lineWidth,r=new l.default(l.default.ACTION_FILL);r.verticesData=this.verticesData,r.fragmentData=this.fragmetData,this[w].push(r),r.collectVertexDataForStroke(n,t,e*t[3],[0,0],a,this.currentFaceVector)}},{key:"createImageData",value:function(t,e){if(1==arguments.length){var n=t;t=n.width,e=n.height}var a=new Uint8ClampedArray(t*e*4);return new ImageData(a,t,e)}},{key:"turnOnLight",value:function(){this.webglRender.enableLight(!0)}},{key:"turnOffLight",value:function(){this.webglRender.enableLight(!1)}},{key:"setLightPosition",value:function(t,e,n){this.webglRender.setLightPosition(t,e,n)}},{key:"fillOrStroke",value:function(t,e){null!=t&&(this.fillStyle=t,this.fill()),null!=e&&(this.strokeStyle=e,this.stroke())}},{key:"drawRectangle",value:function(t,e,n,a,r,i){this.save(),this.beginPath(),this.rect(t,e,n,a),this.fillOrStroke(r,i),this.restore()}},{key:"drawEllipse",value:function(t,e,n,a,r,i,u){this.save(),this.beginPath(),this.ellipse(t,e,n,a,u,0,f.default.PI2,!1),this.closePath(),this.fillOrStroke(r,i),this.restore()}},{key:"drawCircle",value:function(t,e,n,a,r){this.drawEllipse(t,e,n,n,a,r,0)}},{key:"draw",value:function(){this.webglRender.initRending(),this.webglRender.executeRenderAction(this[w],this[M]),this[w]=[],this[M]=[],this.verticesData.init(),this.fragmetData.init(),this.transformMatrixData.init()}},{key:"currentContextState",get:function(){if(0==this[k].length){var t=new r.default(new i.default);this[k].push(t),this[M].push(t),t.id=this[M].length-1}return this[k][this[k].length-1]}},{key:"currentPath",get:function(){return 0==this[P].length&&this[P].push(new u.default),this[P][this[P].length-1]}},{key:"canvas",get:function(){return this[p]}},{key:"strokeStyle",set:function(t){this.currentContextState.strokeStyle=t},get:function(){return this.currentContextState.strokeStyle}},{key:"currentFaceVector",get:function(){var t=this.currentContextState.transformMatrix.matrix,e=g.default.TEMP_VECTORS[0],n=g.default.TEMP_VECTORS[1];return c.default.multiplyWithVertex(t,S,e.value),c.default.multiplyWithVertex(t,_,n.value),this.currentFaceNormal[0]=e.x-n.x,this.currentFaceNormal[1]=e.y-n.y,this.currentFaceNormal[2]=e.z-n.z,this.currentFaceNormal}},{key:"fillStyle",set:function(t){this.currentContextState.fillStyle=t},get:function(){return this.currentContextState.fillStyle}},{key:"globalAlpha",set:function(t){this.currentContextState.globalAlpha=t},get:function(){return this.currentContextState.globalAlpha}},{key:"lineWidth",set:function(t){this.currentContextState.lineWidth=t},get:function(){return this.currentContextState.lineWidth}}]),t}();e.default=A},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=u(n(1)),i=u(n(0));function u(t){return t&&t.__esModule?t:{default:t}}Symbol("变换矩阵");var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvasDrawingStyle=e,this.matrixIndex=0,this.fillStyle="#000000",this.strokeStyle="#000000",this.globalAlpha=1,this.id=-1,this.matrixArray=[],this.matrixArray.push(r.default.identity()),this.dirty=!1}return a(t,[{key:"fireDirty",value:function(){this.dirty=!0}},{key:"setTransformMatrix",value:function(t){var e=this.transformMatrix.matrix;r.default.copy(t,e)}},{key:"checkDirty",value:function(){if(this.dirty){var t=r.default.identity(),e=this.transformMatrix.matrix;r.default.copy(e,t),this.matrixArray.push(t),this.dirty=!1}}},{key:"applyTransform",value:function(t){this.checkDirty();var e=this.transformMatrix.matrix;r.default.multiply(e,e,t)}},{key:"translate",value:function(t,e,n){if(void 0===n&&(n=0),!(i.default.equals(t,0)&&i.default.equals(e,0)&&i.default.equals(n,0))){var a=r.default.TEMP_MAT4[0];r.default.translationMatrix(a,t,e,n),this.applyTransform(a)}}},{key:"rotateZ",value:function(t){if(!i.default.equals(t,0)){var e=r.default.TEMP_MAT4[0];r.default.rotationZMatrix(e,t),this.applyTransform(e)}}},{key:"rotateX",value:function(t){if(!i.default.equals(t,0)){var e=r.default.TEMP_MAT4[0];r.default.rotationXMatrix(e,t),this.applyTransform(e)}}},{key:"rotateY",value:function(t){if(!i.default.equals(t,0)){var e=r.default.TEMP_MAT4[0];r.default.rotationYMatrix(e,t),this.applyTransform(e)}}},{key:"scale",value:function(t,e,n){if(void 0===n&&(n=1),!(i.default.equals(t,1)&&i.default.equals(e,1)&&i.default.equals(n,1))){var a=r.default.TEMP_MAT4[0];r.default.scalingMatrix(a,t,e,n),this.applyTransform(a)}}},{key:"clone",value:function(){var e=new t(this.canvasDrawingStyle.clone());return e.fillStyle=this.fillStyle,e.strokeStyle=this.strokeStyle,e.globalAlpha=this.globalAlpha,e.matrixIndex=this.matrixIndex,e.setTransformMatrix(this.transformMatrix.matrix),e}},{key:"transformMatrixId",get:function(){return this.matrixArray.length-1}},{key:"transformMatrix",get:function(){var t=this.matrixArray.length-1;return{matrix:this.matrixArray[t],id:t}}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=Symbol("线宽度,默认1"),i=Symbol('线连接样式，"butt", "round", "square" (默认: "butt")'),u=Symbol('线连接样式，"round", "bevel", "miter" (默认: "miter")'),o=Symbol("默认10"),s=Symbol('文字字体大小等，默认"10px sans-serif"'),l=Symbol('文字对齐,"start", "end", "left", "right", "center" (默认: "start")'),h=Symbol('文字纵向对齐，"top", "hanging", "middle", "alphabetic", "ideographic", "bottom" (默认: "alphabetic")'),f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this[r]=1,this[i]="butt",this[u]="miter",this[o]=10,this.font="10px sans-serif",this.textAlign="start",this.textBaseline="alphabetic"}return a(t,[{key:"clone",value:function(){var e=new t;return e.textBaseline=this.textBaseline,e.textAlign=this.textAlign,e.font=this.font,e.lineCap=this.lineCap,e.lineJoin=this.lineJoin,e.lineWidth=this.lineWidth,e}},{key:"lineCap",get:function(){return this[i]},set:function(t){this[i]=t}},{key:"lineWidth",get:function(){return this[r]},set:function(t){this[r]=t}},{key:"lineJoin",get:function(){return this[u]},set:function(t){this[u]=t}},{key:"miterLimit",get:function(){return this[o]},set:function(t){this[o]=t}},{key:"font",get:function(){return this[s]},set:function(t){this[s]=t}},{key:"textAlign",get:function(){return this[l]},set:function(t){this[l]=t}},{key:"textBaseline",get:function(){return this[h]},set:function(t){this[h]=t}}]),t}();e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subPathArray=[]}return a(t,[{key:"addSubPath",value:function(t){this.subPathArray.push(t)}},{key:"clean",value:function(){this.subPathArray=[]}},{key:"subPathNumber",get:function(){return this.subPathArray.length}},{key:"lastSubPath",get:function(){if(0!=this.subPathNumber)return this.subPathArray[this.subPathNumber-1]}}]),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=Symbol("当前的点所在的索引位置"),i=Symbol("点的坐标值数组,每三个为一组，分别是x,y,z"),u=Symbol("点的坐标值数组，每两个为一组，分别是stateId,matrixId"),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pointsArray=[],this[r]=0,this[i]=[],this[u]=[],null!=e&&null!=e&&this.pushPoint(e),this.isClosed=!1}return a(t,[{key:"init",value:function(){this.isClosed=!1,this[r]=0}},{key:"getPointX",value:function(t){return t*=3,this[i][t]}},{key:"getPointY",value:function(t){return t*=3,this[i][t+1]}},{key:"getPointZ",value:function(t){return t*=3,this[i][t+2]}},{key:"getPointStateId",value:function(t){return t*=2,this[u][t]}},{key:"getPointMatrixId",value:function(t){return t*=2,this[u][t+1]}},{key:"getPointMatrixData",value:function(t){return[this.getPointStateId(t),this.getPointMatrixId(t)]}},{key:"setPoint",value:function(t,e,n,a,r,o){r=r||0,o=o||0;var s=2*t;t*=3,this[i][t]=e,this[i][t+1]=n,this[i][t+2]=a,this[u][s]=r,this[u][s+1]=o}},{key:"addPoint",value:function(t,e,n,a,o){a=a||0,o=o||0;var s=this[r];3*s>=this[i].length?(this[i].push(t),this[i].push(e),this[i].push(n)):(this[i][s]=t,this[i][s+1]=e,this[i][s+2]=n),2*s>=this[u].length?(this[u].push(a),this[u].push(o)):(this[u][s]=a,this[u][s+1]=o),this[r]++}},{key:"close",value:function(){this.isClosed=!0}},{key:"getPoint",value:function(t){return this.pointsArray[t]}},{key:"clean",value:function(){this.pointsArray=[],this.isClosed=!1}},{key:"pushPoint",value:function(t){this.pointsArray.push(t)}},{key:"pointsCoordinateArray",get:function(){return this[i]}},{key:"pointsNumber",get:function(){return this[r]}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(13),u=(a=i)&&a.__esModule?a:{default:a};var o=void 0,s=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o)return o;o=this,this.colorMap={}}return r(t,[{key:"convertStringToColor",value:function(e){var n=this.colorMap[e];return null!=n?n:(e=e.toLowerCase(),t.isRGBAString(e)?this.rgba2vec(e):t.isHSLAString(e)?this.hsla2vet3(e):this.getVec(e,e,1))}},{key:"hsla2vet3",value:function(t){var e=t,n=this.colorMap[e];if(null!=n)return n;var a=1;if(3==(t=(t=t.match(new RegExp(",","g")))||[]).length){var r=(t=e).lastIndexOf(","),i=t.lastIndexOf(")"),u=t.substring(r+1,i);a=parseFloat(u),t=t.substring(0,r),t+=")"}else t=e;t=t.replace("a","");var o=w3color(t);return o.valid?(n=[o.r,o.g,o.b,a],this.colorMap[e]=n,n):[0,0,0,1]}},{key:"rgba2vec",value:function(t){var e=t,n=this.colorMap[e];if(null!=n)return n;var a=1;if(3==(t=(t=t.match(new RegExp(",","g")))||[]).length){var r=(t=e).lastIndexOf(","),i=t.lastIndexOf(")"),u=t.substring(r+1,i);a=parseFloat(u),t=t.substring(0,r),t+=")"}else t=e;return t=t.replace("a",""),this.getVec(t,e,a)}},{key:"getVec",value:function(t,e,n){var a=this.colorMap[e];if(null!=a)return a;var r=new u.default(t);if(r.valid){var i=r.toRgb(),o=[i.r,i.g,i.b,n];return null==this.colorMap[e]&&(this.colorMap[e]=o),o}return[0,0,0,1]}}],[{key:"getInstance",value:function(){return o||(o=new t),o}},{key:"isRGBAString",value:function(t){return!(!t||0!=t.indexOf("rgba"))}},{key:"isHSLAString",value:function(t){return!(!t||0!=t.indexOf("hsla"))}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var u=function(){function t(e,n){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this instanceof t?"object"==(void 0===e?"undefined":a(e))?e:(this.attachValues(t.toColorObject(e)),void(n&&(n.style.backgroundColor=this.toRgbString()))):new t(e,n)}return r(t,[{key:"attachValues",value:function(t){this.red=t.red,this.green=t.green,this.blue=t.blue,this.hue=t.hue,this.sat=t.sat,this.lightness=t.lightness,this.whiteness=t.whiteness,this.blackness=t.blackness,this.cyan=t.cyan,this.magenta=t.magenta,this.yellow=t.yellow,this.black=t.black,this.ncol=t.ncol,this.opacity=t.opacity,this.valid=t.valid}},{key:"toRgbString",value:function(){return"rgb("+this.red+", "+this.green+", "+this.blue+")"}},{key:"toRgbaString",value:function(){return"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.opacity+")"}},{key:"toHwbString",value:function(){return"hwb("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%)"}},{key:"toHwbStringDecimal",value:function(){return"hwb("+this.hue+", "+this.whiteness+", "+this.blackness+")"}},{key:"toHwbaString",value:function(){return"hwba("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity+")"}},{key:"toHslString",value:function(){return"hsl("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%)"}},{key:"toHslStringDecimal",value:function(){return"hsl("+this.hue+", "+this.sat+", "+this.lightness+")"}},{key:"toHslaString",value:function(){return"hsla("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%, "+this.opacity+")"}},{key:"toCmykString",value:function(){return"cmyk("+Math.round(100*this.cyan)+"%, "+Math.round(100*this.magenta)+"%, "+Math.round(100*this.yellow)+"%, "+Math.round(100*this.black)+"%)"}},{key:"toCmykStringDecimal",value:function(){return"cmyk("+this.cyan+", "+this.magenta+", "+this.yellow+", "+this.black+")"}},{key:"toNcolString",value:function(){return this.ncol+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%"}},{key:"toNcolStringDecimal",value:function(){return this.ncol+", "+this.whiteness+", "+this.blackness}},{key:"toNcolaString",value:function(){return this.ncol+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity}},{key:"toName",value:function(){var t,e,n,a=getColorArr("hexs");for(i=0;i<a.length;i++)if(t=parseInt(a[i].substr(0,2),16),e=parseInt(a[i].substr(2,2),16),n=parseInt(a[i].substr(4,2),16),this.red==t&&this.green==e&&this.blue==n)return getColorArr("names")[i];return""}},{key:"toHexString",value:function(){return"#"+toHex(this.red)+toHex(this.green)+toHex(this.blue)}},{key:"toRgb",value:function(){return{r:this.red,g:this.green,b:this.blue,a:this.opacity}}},{key:"toHsl",value:function(){return{h:this.hue,s:this.sat,l:this.lightness,a:this.opacity}}},{key:"toHwb",value:function(){return{h:this.hue,w:this.whiteness,b:this.blackness,a:this.opacity}}},{key:"toCmyk",value:function(){return{c:this.cyan,m:this.magenta,y:this.yellow,k:this.black,a:this.opacity}}},{key:"toNcol",value:function(){return{ncol:this.ncol,w:this.whiteness,b:this.blackness,a:this.opacity}}},{key:"isDark",value:function(t){var e=t||128;return(299*this.red+587*this.green+114*this.blue)/1e3<e}},{key:"saturate",value:function(t){var e,n,a;e=t/100||.1,this.sat+=e,this.sat>1&&(this.sat=1),n=hslToRgb(this.hue,this.sat,this.lightness),a=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(a)}},{key:"desaturate",value:function(t){var e,n,a;e=t/100||.1,this.sat-=e,this.sat<0&&(this.sat=0),n=hslToRgb(this.hue,this.sat,this.lightness),a=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(a)}},{key:"lighter",value:function(t){var e,n,a;e=t/100||.1,this.lightness+=e,this.lightness>1&&(this.lightness=1),n=hslToRgb(this.hue,this.sat,this.lightness),a=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(a)}},{key:"darker",value:function(t){var e,n,a;e=t/100||.1,this.lightness-=e,this.lightness<0&&(this.lightness=0),n=hslToRgb(this.hue,this.sat,this.lightness),a=colorObject(n,this.opacity,this.hue,this.sat),this.attachValues(a)}}],[{key:"w3color",value:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){return this instanceof w3color?"object"==(void 0===t?"undefined":a(t))?t:(this.attachValues(toColorObject(t)),void(e&&(e.style.backgroundColor=this.toRgbString()))):new w3color(t,e)})},{key:"toColorObject",value:function(t){var e,n,a,r,i,u,o,s,l,h,f,c=[],d=[],y=[];if(e=(t=this.w3trim(t.toLowerCase())).substr(0,1).toUpperCase(),n=t.substr(1),s=1,"R"!=e&&"Y"!=e&&"G"!=e&&"C"!=e&&"B"!=e&&"M"!=e&&"W"!=e||isNaN(n)||6==t.length&&-1==t.indexOf(",")||(t="ncol("+t+")"),3==t.length||6==t.length||isNaN(t)||(t="ncol("+t+")"),t.indexOf(",")>0&&-1==t.indexOf("(")&&(t="ncol("+t+")"),"rgb"==t.substr(0,3)||"hsl"==t.substr(0,3)||"hwb"==t.substr(0,3)||"ncol"==t.substr(0,4)||"cmyk"==t.substr(0,4)){if("ncol"==t.substr(0,4)?(4==t.split(",").length&&-1==t.indexOf("ncola")&&(t=t.replace("ncol","ncola")),a="ncol",t=t.substr(4)):"cmyk"==t.substr(0,4)?(a="cmyk",t=t.substr(4)):(a=t.substr(0,3),t=t.substr(3)),r=3,u=!1,"a"==t.substr(0,1).toLowerCase()?(r=4,u=!0,t=t.substr(1)):"cmyk"==a&&(r=4,5==t.split(",").length&&(r=5,u=!0)),c=(t=(t=t.replace("(","")).replace(")","")).split(","),"rgb"==a){if(c.length!=r)return this.emptyObject();for(i=0;i<r;i++){if(""!=c[i]&&" "!=c[i]||(c[i]="0"),c[i].indexOf("%")>-1&&(c[i]=c[i].replace("%",""),c[i]=Number(c[i]/100),i<3&&(c[i]=Math.round(255*c[i]))),isNaN(c[i]))return this.emptyObject();parseInt(c[i])>255&&(c[i]=255),i<3&&(c[i]=parseInt(c[i])),3==i&&Number(c[i])>1&&(c[i]=1)}f={r:c[0],g:c[1],b:c[2]},1==u&&(s=Number(c[3]))}if("hsl"==a||"hwb"==a||"ncol"==a){for(;c.length<r;)c.push("0");for("hsl"!=a&&"hwb"!=a||parseInt(c[0])>=360&&(c[0]=0),i=1;i<r;i++){if(c[i].indexOf("%")>-1){if(c[i]=c[i].replace("%",""),c[i]=Number(c[i]),isNaN(c[i]))return this.emptyObject();c[i]=c[i]/100}else c[i]=Number(c[i]);Number(c[i])>1&&(c[i]=1),Number(c[i])<0&&(c[i]=0)}"hsl"==a&&(f=this.hslToRgb(c[0],c[1],c[2]),l=Number(c[0]),h=Number(c[1])),"hwb"==a&&(f=this.hwbToRgb(c[0],c[1],c[2])),"ncol"==a&&(f=this.ncolToRgb(c[0],c[1],c[2])),1==u&&(s=Number(c[3]))}if("cmyk"==a){for(;c.length<r;)c.push("0");for(i=0;i<r;i++){if(c[i].indexOf("%")>-1){if(c[i]=c[i].replace("%",""),c[i]=Number(c[i]),isNaN(c[i]))return this.emptyObject();c[i]=c[i]/100}else c[i]=Number(c[i]);Number(c[i])>1&&(c[i]=1),Number(c[i])<0&&(c[i]=0)}f=this.cmykToRgb(c[0],c[1],c[2],c[3]),1==u&&(s=Number(c[4]))}}else if("ncs"==t.substr(0,3))f=this.ncsToRgb(t);else{for(o=!1,d=this.getColorArr("names"),i=0;i<d.length;i++)if(t.toLowerCase()==d[i].toLowerCase()){y=this.getColorArr("hexs"),o=!0,f={r:parseInt(y[i].substr(0,2),16),g:parseInt(y[i].substr(2,2),16),b:parseInt(y[i].substr(4,2),16)};break}if(0==o){for(3==(t=t.replace("#","")).length&&(t=t.substr(0,1)+t.substr(0,1)+t.substr(1,1)+t.substr(1,1)+t.substr(2,1)+t.substr(2,1)),i=0;i<t.length;i++)if(!this.isHex(t.substr(i,1)))return this.emptyObject();for(c[0]=parseInt(t.substr(0,2),16),c[1]=parseInt(t.substr(2,2),16),c[2]=parseInt(t.substr(4,2),16),i=0;i<3;i++)if(isNaN(c[i]))return this.emptyObject();f={r:c[0],g:c[1],b:c[2]}}}return this.colorObject(f,s,l,h)}},{key:"colorObject",value:function(t,e,n,a){var r,i,u,o,s,l,h;return t?(e||(e=1),r=this.rgbToHsl(t.r,t.g,t.b),i=this.rgbToHwb(t.r,t.g,t.b),u=this.rgbToCmyk(t.r,t.g,t.b),l=n||r.h,h=a||r.s,o=this.hueToNcol(l),s={red:t.r,green:t.g,blue:t.b,hue:l,sat:h,lightness:r.l,whiteness:i.w,blackness:i.b,cyan:u.c,magenta:u.m,yellow:u.y,black:u.k,ncol:o,opacity:e,valid:!0},s=this.roundDecimals(s)):this.emptyObject()}},{key:"emptyObject",value:function(){return{red:0,green:0,blue:0,hue:0,sat:0,lightness:0,whiteness:0,blackness:0,cyan:0,magenta:0,yellow:0,black:0,ncol:"R",opacity:1,valid:!1}}},{key:"getColorArr",value:function(t){return"names"==t?["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"]:"hexs"==t?["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"]:void 0}},{key:"roundDecimals",value:function(t){return t.red=Number(t.red.toFixed(0)),t.green=Number(t.green.toFixed(0)),t.blue=Number(t.blue.toFixed(0)),t.hue=Number(t.hue.toFixed(0)),t.sat=Number(t.sat.toFixed(2)),t.lightness=Number(t.lightness.toFixed(2)),t.whiteness=Number(t.whiteness.toFixed(2)),t.blackness=Number(t.blackness.toFixed(2)),t.cyan=Number(t.cyan.toFixed(2)),t.magenta=Number(t.magenta.toFixed(2)),t.yellow=Number(t.yellow.toFixed(2)),t.black=Number(t.black.toFixed(2)),t.ncol=t.ncol.substr(0,1)+Math.round(Number(t.ncol.substr(1))),t.opacity=Number(t.opacity.toFixed(2)),t}},{key:"hslToRgb",value:function(t,e,n){var a,r;return t/=60,a=2*n-(r=n<=.5?n*(e+1):n+e-n*e),{r:255*hueToRgb(a,r,t+2),g:255*hueToRgb(a,r,t),b:255*hueToRgb(a,r,t-2)}}},{key:"hueToRgb",value:function(t,e,n){return n<0&&(n+=6),n>=6&&(n-=6),n<1?(e-t)*n+t:n<3?e:n<4?(e-t)*(4-n)+t:t}},{key:"hwbToRgb",value:function(t,e,n){var a,r,i,u=[];for(r=hslToRgb(t,1,.5),u[0]=r.r/255,u[1]=r.g/255,u[2]=r.b/255,(i=e+n)>1&&(e=Number((e/i).toFixed(2)),n=Number((n/i).toFixed(2))),a=0;a<3;a++)u[a]*=1-e-n,u[a]+=e,u[a]=Number(255*u[a]);return{r:u[0],g:u[1],b:u[2]}}},{key:"cmykToRgb",value:function(t,e,n,a){return{r:255-255*Math.min(1,t*(1-a)+a),g:255-255*Math.min(1,e*(1-a)+a),b:255-255*Math.min(1,n*(1-a)+a)}}},{key:"ncolToRgb",value:function(t,e,n){var a,r,i;if(i=t,isNaN(t.substr(0,1))){if(a=t.substr(0,1).toUpperCase(),""==(r=t.substr(1))&&(r=0),r=Number(r),isNaN(r))return!1;"R"==a&&(i=0+.6*r),"Y"==a&&(i=60+.6*r),"G"==a&&(i=120+.6*r),"C"==a&&(i=180+.6*r),"B"==a&&(i=240+.6*r),"M"==a&&(i=300+.6*r),"W"==a&&(i=0,e=1-r/100,n=r/100)}return hwbToRgb(i,e,n)}},{key:"hueToNcol",value:function(t){for(;t>=360;)t-=360;return t<60?"R"+t/.6:t<120?"Y"+(t-60)/.6:t<180?"G"+(t-120)/.6:t<240?"C"+(t-180)/.6:t<300?"B"+(t-240)/.6:t<360?"M"+(t-300)/.6:void 0}},{key:"ncsToRgb",value:function(t){var e,n,a,r,i,u,o,s,l,h,f,c,d,y,v,g,x;if(-1==(t=(t=(t=(t=(t=w3trim(t).toUpperCase()).replace("(","")).replace(")","")).replace("NCS","NCS ")).replace(/  /g," ")).indexOf("NCS")&&(t="NCS "+t),null===(t=t.match(/^(?:NCS|NCS\sS)\s(\d{2})(\d{2})-(N|[A-Z])(\d{2})?([A-Z])?$/)))return!1;if(e=parseInt(t[1],10),n=parseInt(t[2],10),"N"!=(a=t[3])&&"Y"!=a&&"R"!=a&&"B"!=a&&"G"!=a)return!1;if(r=parseInt(t[4],10)||0,"N"!==a){i=1.05*e-5.25,u=n,"Y"===a&&r<=60?l=1:"Y"===a&&r>60||"R"===a&&r<=80?(o="Y"===a?r-60:r+40,l=(Math.sqrt(14884-Math.pow(o,2))-22)/100):"R"===a&&r>80||"B"===a?l=0:"G"===a&&(o=r-170,l=(Math.sqrt(33800-Math.pow(o,2))-70)/100),"Y"===a&&r<=80?s=0:"Y"===a&&r>80||"R"===a&&r<=60?(o="Y"===a?r-80+20.5:r+20+20.5,s=(104-Math.sqrt(11236-Math.pow(o,2)))/100):"R"===a&&r>60||"B"===a&&r<=80?(o="R"===a?r-60-60:r+40-60,s=(Math.sqrt(1e4-Math.pow(o,2))-10)/100):"B"===a&&r>80||"G"===a&&r<=40?(o="B"===a?r-80-131:r+20-131,s=(122-Math.sqrt(19881-Math.pow(o,2)))/100):"G"===a&&r>40&&(s=0);var b=void 0;"Y"===a?b=(85-.85*r)/100:"R"===a&&r<=60?b=0:"R"===a&&r>60?(o=r-60+35,b=(67.5-Math.sqrt(5776-Math.pow(o,2)))/100):"B"===a&&r<=60?(o=1*r-68.5,b=(6.5+Math.sqrt(7044.5-Math.pow(o,2)))/100):"B"===a&&r>60||"G"===a&&r<=60?b=.9:"G"===a&&r>60&&(b=(90-1/8*(o=r-60))/100),c=((o=(l+b+s)/3)-s)*(100-u)/100+s,d=1/((h=(o-l)*(100-u)/100+l)>(f=(o-b)*(100-u)/100+b)&&h>c?h:f>h&&f>c?f:c>h&&c>f?c:(h+f+c)/3),(v=parseInt(h*d*(100-i)/100*255,10))>255&&(v=255),(g=parseInt(f*d*(100-i)/100*255,10))>255&&(g=255),(x=parseInt(c*d*(100-i)/100*255,10))>255&&(x=255),v<0&&(v=0),g<0&&(g=0),x<0&&(x=0)}else(y=parseInt(255*(1-e/100),10))>255&&(y=255),y<0&&(y=0),v=y,g=y,x=y;return{r:v,g:g,b:x}}},{key:"rgbToHsl",value:function(t,e,n){var a,r,i,u,o,s,l=[];for(l[0]=t/255,l[1]=e/255,l[2]=n/255,a=l[0],r=l[0],o=0,i=0;i<l.length-1;i++)l[i+1]<=a&&(a=l[i+1]),l[i+1]>=r&&(r=l[i+1],o=i+1);return 0==o&&(s=(l[1]-l[2])/(r-a)),1==o&&(s=2+(l[2]-l[0])/(r-a)),2==o&&(s=4+(l[0]-l[1])/(r-a)),isNaN(s)&&(s=0),(s*=60)<0&&(s+=360),u=(a+r)/2,{h:s,s:a==r?0:u<.5?(r-a)/(r+a):(r-a)/(2-r-a),l:u}}},{key:"rgbToHwb",value:function(t,e,n){t/=255,e/=255,n/=255;var a=Math.max(t,e,n),r=Math.min(t,e,n),i=a-r;return{h:0==i?0:t==a?(e-n)/i%6*360:e==a?((n-t)/i+2)%6*360:((t-e)/i+4)%6*360,w:r,b:1-a}}},{key:"rgbToCmyk",value:function(t,e,n){var a,r,i,u;return t/=255,e/=255,n/=255,1==(u=1-Math.max(t,e,n))?(a=0,r=0,i=0):(a=(1-t-u)/(1-u),r=(1-e-u)/(1-u),i=(1-n-u)/(1-u)),{c:a,m:r,y:i,k:u}}},{key:"toHex",value:function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e}},{key:"cl",value:function(t){console.log(t)}},{key:"w3trim",value:function(t){return t.replace(/^\s+|\s+$/g,"")}},{key:"isHex",value:function(t){return"0123456789ABCDEFabcdef".indexOf(t)>-1}}]),t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=u(n(15)),i=u(n(17));function u(t){return t&&t.__esModule?t:{default:t}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.textureIndex=-1,this.verticesData=null,this.fragmentData=null,this.transformData=null,this.renderPointNumber=0,this.isRect=!1}return a(t,[{key:"collectVertexDataForStroke",value:function(t,e,n,a,r,u){for(var o=0;o<t.length;o++)for(var s=t[o],l=0;l<s.subPathNumber;l++){var h=s.subPathArray[l];if(!(h.pointsNumber<2)){for(var f=i.default.generatePoints1(r,h.pointsCoordinateArray,h.isClosed,u),c=f.length/3,d=0;d<c;d++){var y=3*d;null!=this.verticesData&&this.verticesData.addVerticesData(f[y],f[y+1],f[y+2],u[0],u[1],u[2]),null!=this.fragmentData&&this.fragmentData.addFragmentData(e[0],e[1],e[2],n,a[0],a[1],-1),null!=this.transformData&&this.transformData.addMatrixIndex(0)}this.renderPointNumber+=c}}}},{key:"collectVertexDataForFill",value:function(t,e,n,a,i){for(var u=0;u<t.length;u++){var o=t[u];if(0!=o.subPathNumber)for(var s=0;s<o.subPathNumber;s++){var l=o.subPathArray[s];if(!(l.pointsNumber<3)){var h=void 0,f=l.pointsCoordinateArray,c=l.pointsNumber;if(3==c)h=[0,1,2];else if(3*c==f.length)h=r.default.earcut(f,null,3);else{var d=f.slice(0,3*c);h=r.default.earcut(d,null,3)}this.renderPointNumber+=h.length;for(var y=0;y<h.length;y++){var v=h[y];if(null!=this.verticesData&&this.verticesData.addVerticesData(l.getPointX(v),l.getPointY(v),l.getPointZ(v),i[0],i[1],i[2]),null!=this.fragmentData){var g=void 0;g=a[0]instanceof Array?a[v]:a,this.fragmentData.addFragmentData(e[0],e[1],e[2],n,g[0],g[1],this.textureIndex)}null!=this.transformData&&this.transformData.addMatrixIndex(0)}}}}}}],[{key:"ACTION_STROKE",get:function(){return 0}},{key:"ACTION_FILL",get:function(){return 1}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(16),u=(a=i)&&a.__esModule?a:{default:a};var o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"earcut",value:function(t,e,n){n=n||2;var a=e&&e.length,r=a?e[0]*n:t.length,i=this.linkedList(t,0,r,n,!0),u=[];if(!i||i.next===i.prev)return u;var o=void 0,s=void 0,l=void 0,h=void 0,f=void 0,c=void 0,d=void 0;if(a&&(i=this.eliminateHoles(t,e,i,n)),t.length>80*n){o=l=t[0],s=h=t[1];for(var y=n;y<r;y+=n)(f=t[y])<o&&(o=f),(c=t[y+1])<s&&(s=c),f>l&&(l=f),c>h&&(h=c);d=0!==(d=Math.max(l-o,h-s))?1/d:0}return this.earcutLinked(i,u,n,o,s,d),u}},{key:"linkedList",value:function(e,n,a,r,i){var u,o;if(i===t.signedArea(e,n,a,r)>0)for(u=n;u<a;u+=r)o=this.insertNode(u,e[u],e[u+1],o);else for(u=a-r;u>=n;u-=r)o=this.insertNode(u,e[u],e[u+1],o);return o&&t.equals(o,o.next)&&(this.removeNode(o),o=o.next),o}},{key:"filterPoints",value:function(e,n){if(!e)return e;n||(n=e);var a,r=e;do{if(a=!1,r.steiner||!t.equals(r,r.next)&&0!==t.area(r.prev,r,r.next))r=r.next;else{if(this.removeNode(r),(r=n=r.prev)===r.next)break;a=!0}}while(a||r!==n);return n}},{key:"earcutLinked",value:function(t,e,n,a,r,i,u){if(t){!u&&i&&this.indexCurve(t,a,r,i);for(var o,s,l=t;t.prev!==t.next;)if(o=t.prev,s=t.next,i?this.isEarHashed(t,a,r,i):this.isEar(t))e.push(o.i/n),e.push(t.i/n),e.push(s.i/n),this.removeNode(t),t=s.next,l=s.next;else if((t=s)===l){u?1===u?(t=this.cureLocalIntersections(t,e,n),this.earcutLinked(t,e,n,a,r,i,2)):2===u&&this.splitEarcut(t,e,n,a,r,i):this.earcutLinked(this.filterPoints(t),e,n,a,r,i,1);break}}}},{key:"isEar",value:function(e){var n=e.prev,a=e,r=e.next;if(this.area(n,a,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(this.pointInTriangle(n.x,n.y,a.x,a.y,r.x,r.y,i.x,i.y)&&t.area(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}},{key:"isEarHashed",value:function(e,n,a,r){var i=e.prev,u=e,o=e.next;if(this.area(i,u,o)>=0)return!1;for(var s=i.x<u.x?i.x<o.x?i.x:o.x:u.x<o.x?u.x:o.x,l=i.y<u.y?i.y<o.y?i.y:o.y:u.y<o.y?u.y:o.y,h=i.x>u.x?i.x>o.x?i.x:o.x:u.x>o.x?u.x:o.x,f=i.y>u.y?i.y>o.y?i.y:o.y:u.y>o.y?u.y:o.y,c=this.zOrder(s,l,n,a,r),d=this.zOrder(h,f,n,a,r),y=e.prevZ,v=e.nextZ;y&&y.z>=c&&v&&v.z<=d;){if(y!==e.prev&&y!==e.next&&this.pointInTriangle(i.x,i.y,u.x,u.y,o.x,o.y,y.x,y.y)&&t.area(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,v!==e.prev&&v!==e.next&&this.pointInTriangle(i.x,i.y,u.x,u.y,o.x,o.y,v.x,v.y)&&t.area(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;y&&y.z>=c;){if(y!==e.prev&&y!==e.next&&this.pointInTriangle(i.x,i.y,u.x,u.y,o.x,o.y,y.x,y.y)&&t.area(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;v&&v.z<=d;){if(v!==e.prev&&v!==e.next&&this.pointInTriangle(i.x,i.y,u.x,u.y,o.x,o.y,v.x,v.y)&&t.area(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}},{key:"cureLocalIntersections",value:function(e,n,a){var r=e;do{var i=r.prev,u=r.next.next;!t.equals(i,u)&&this.intersects(i,r,r.next,u)&&this.locallyInside(i,u)&&this.locallyInside(u,i)&&(n.push(i.i/a),n.push(r.i/a),n.push(u.i/a),this.removeNode(r),this.removeNode(r.next),r=e=u),r=r.next}while(r!==e);return r}},{key:"splitEarcut",value:function(t,e,n,a,r,i){var u=t;do{for(var o=u.next.next;o!==u.prev;){if(u.i!==o.i&&this.isValidDiagonal(u,o)){var s=this.splitPolygon(u,o);return u=this.filterPoints(u,u.next),s=this.filterPoints(s,s.next),this.earcutLinked(u,e,n,a,r,i),void this.earcutLinked(s,e,n,a,r,i)}o=o.next}u=u.next}while(u!==t)}},{key:"eliminateHoles",value:function(t,e,n,a){var r,i,u,o,s,l=[];for(r=0,i=e.length;r<i;r++)u=e[r]*a,o=r<i-1?e[r+1]*a:t.length,(s=this.linkedList(t,u,o,a,!1))===s.next&&(s.steiner=!0),l.push(this.getLeftmost(s));for(l.sort(this.compareX),r=0;r<l.length;r++)this.eliminateHole(l[r],n),n=this.filterPoints(n,n.next);return n}},{key:"compareX",value:function(t,e){return t.x-e.x}},{key:"eliminateHole",value:function(t,e){if(e=this.findHoleBridge(t,e)){var n=this.splitPolygon(e,t);this.filterPoints(n,n.next)}}},{key:"findHoleBridge",value:function(t,e){var n,a=e,r=t.x,i=t.y,u=-1/0;do{if(i<=a.y&&i>=a.next.y&&a.next.y!==a.y){var o=a.x+(i-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(o<=r&&o>u){if(u=o,o===r){if(i===a.y)return a;if(i===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==e);if(!n)return null;if(r===u)return n.prev;var s,l=n,h=n.x,f=n.y,c=1/0;for(a=n.next;a!==l;)r>=a.x&&a.x>=h&&r!==a.x&&this.pointInTriangle(i<f?r:u,i,h,f,i<f?u:r,i,a.x,a.y)&&((s=Math.abs(i-a.y)/(r-a.x))<c||s===c&&a.x>n.x)&&this.locallyInside(a,t)&&(n=a,c=s),a=a.next;return n}},{key:"indexCurve",value:function(t,e,n,a){var r=t;do{null===r.z&&(r.z=this.zOrder(r.x,r.y,e,n,a)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,this.sortLinked(r)}},{key:"sortLinked",value:function(t){var e,n,a,r,i,u,o,s,l=1;do{for(n=t,t=null,i=null,u=0;n;){for(u++,a=n,o=0,e=0;e<l&&(o++,a=a.nextZ);e++);for(s=l;o>0||s>0&&a;)0!==o&&(0===s||!a||n.z<=a.z)?(r=n,n=n.nextZ,o--):(r=a,a=a.nextZ,s--),i?i.nextZ=r:t=r,r.prevZ=i,i=r;n=a}i.nextZ=null,l*=2}while(u>1);return t}},{key:"zOrder",value:function(t,e,n,a,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-a)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}},{key:"getLeftmost",value:function(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}},{key:"pointInTriangle",value:function(t,e,n,a,r,i,u,o){return(r-u)*(e-o)-(t-u)*(i-o)>=0&&(t-u)*(a-o)-(n-u)*(e-o)>=0&&(n-u)*(i-o)-(r-u)*(a-o)>=0}},{key:"isValidDiagonal",value:function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!this.intersectsPolygon(t,e)&&this.locallyInside(t,e)&&this.locallyInside(e,t)&&this.middleInside(t,e)}},{key:"area",value:function(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}},{key:"intersects",value:function(e,n,a,r){return!!(t.equals(e,n)&&t.equals(a,r)||t.equals(e,r)&&t.equals(a,n))||t.area(e,n,a)>0!=t.area(e,n,r)>0&&t.area(a,r,e)>0!=t.area(a,r,n)>0}},{key:"intersectsPolygon",value:function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&this.intersects(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}},{key:"locallyInside",value:function(e,n){return t.area(e.prev,e,e.next)<0?t.area(e,n,e.next)>=0&&t.area(e,e.prev,n)>=0:t.area(e,n,e.prev)<0||t.area(e,e.next,n)<0}},{key:"middleInside",value:function(t,e){var n=t,a=!1,r=(t.x+e.x)/2,i=(t.y+e.y)/2;do{n.y>i!=n.next.y>i&&n.next.y!==n.y&&r<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(a=!a),n=n.next}while(n!==t);return a}},{key:"splitPolygon",value:function(t,e){var n=new u.default(t.i,t.x,t.y),a=new u.default(e.i,e.x,e.y),r=t.next,i=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,a.next=n,n.prev=a,i.next=a,a.prev=i,a}},{key:"insertNode",value:function(t,e,n,a){var r=new u.default(t,e,n);return a?(r.next=a.next,r.prev=a,a.next.prev=r,a.next=r):(r.prev=r,r.next=r),r}},{key:"removeNode",value:function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}},{key:"signedArea",value:function(t,e,n,a){for(var r=0,i=e,u=n-a;i<n;i+=a)r+=(t[u]-t[i])*(t[i+1]+t[u+1]),u=i;return r}},{key:"deviation",value:function(t,e,n,a){var r=e&&e.length,i=r?e[0]*n:t.length,u=Math.abs(this.signedArea(t,0,i,n));if(r)for(var o=0,s=e.length;o<s;o++){var l=e[o]*n,h=o<s-1?e[o+1]*n:t.length;u-=Math.abs(this.signedArea(t,l,h,n))}var f=0;for(o=0;o<a.length;o+=3){var c=a[o]*n,d=a[o+1]*n,y=a[o+2]*n;f+=Math.abs((t[c]-t[y])*(t[d+1]-t[c+1])-(t[c]-t[d])*(t[y+1]-t[c+1]))}return 0===u&&0===f?0:Math.abs((f-u)/u)}},{key:"flatten",value:function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},a=0,r=0;r<t.length;r++){for(var i=0;i<t[r].length;i++)for(var u=0;u<e;u++)n.vertices.push(t[r][i][u]);r>0&&(a+=t[r-1].length,n.holes.push(a))}return n}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function t(e,n,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.i=e,this.x=n,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=o(n(2)),i=o(n(3)),u=o(n(0));function o(t){return t&&t.__esModule?t:{default:t}}Math.PI;var s=new r.default(0,0,0),l=new r.default(0,0,0),h=(new r.default(0,0,0),new r.default(0,0,0),new Float32Array(1)),f=new r.default,c=new r.default(0,0,0),d=new r.default(0,0,0),y=new r.default(0,0,0),v=new r.default(0,0,0),g=new r.default(0,0,0),x=new r.default(0,0,0),b=new r.default(0,0,0),m=new r.default(0,0,0),p=new r.default(0,0,0),k=new r.default,M=new r.default(0,0,0),P=new r.default(0,0,0),w=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return a(t,null,[{key:"generatePoints1",value:function(t,e,n,a){if(null==t&&(t=1),h[0]=t/2,0,null==e||e.length/3<2)return null;f.x=a[0],f.y=a[1],f.z=a[2];var u={r1:null,r2:null,r3:null,r4:null},o=[],P=e.length/3-1;r.default.normalize(f,f),n&&P++;for(var w=0;w<P;w++){var T=3*w,S=e[T],_=e[T+1];s.x=S,s.y=_,s.z=e[T+2];var I=3*(w+1);I>=e.length&&(I=0);var A=e[I],E=e[I+1];l.x=A,l.y=E,l.z=e[I+2],M.x=A-S,M.y=E-_,M.z=l.z-s.z;var C=r.default.TEMP_VECTORS[0];r.default.cross(C,M,f),r.default.normalize(C,C),C.x*=h[0],C.y*=h[0],C.z*=h[0],r.default.plus(g,C,s),r.default.plus(x,C,l),C.x=-C.x,C.y=-C.y,C.z=-C.z,r.default.plus(b,C,l),r.default.plus(m,C,s);var D=u.r1,L=u.r4,O=u.r2,R=u.r3;null!=D&&this.updateConnectPoints(D,O,R,L,g,x,b,m,w,M,f,o,10*t),this.addPoint(g,o),this.addPoint(x,o),this.addPoint(b,o),this.addPoint(b,o),this.addPoint(m,o),this.addPoint(g,o),c.value[0]=g.value[0],c.value[1]=g.value[1],c.value[2]=g.value[2],d.value[0]=x.value[0],d.value[1]=x.value[1],d.value[2]=x.value[2],y.value[0]=b.value[0],y.value[1]=b.value[1],y.value[2]=b.value[2],v.value[0]=m.value[0],v.value[1]=m.value[1],v.value[2]=m.value[2],u.r1=c,u.r2=d,u.r3=y,u.r4=v}if(n){var N=o.length/3,B=this.getPoint(0,o);r.default.copy(B,g);var z=this.getPoint(1,o);r.default.copy(z,x);var V=this.getPoint(N-1,o);r.default.copy(V,c);var F=this.getPoint(N-5,o);r.default.copy(F,d);var j=this.getPoint(4,o);r.default.copy(j,m);var U=this.getPoint(N-3,o);r.default.copy(U,y);var G=this.getPoint(N-2,o);r.default.copy(G,v),p.x=d.x-c.x,p.y=d.y-c.y,p.z=d.z-c.z;var W=p;r.default.normalize(W,W);var q=r.default.TEMP_VECTORS[1];q.x=g.x-x.x,q.y=g.y-x.y,q.z=g.z-x.z;var Y=k;r.default.cross(Y,q,f),r.default.normalize(Y,Y);var H=r.default.TEMP_VECTORS[0];i.default.calculateIntersectionOfPlane(Y,W,d,x,H);null!=H&&(this.setPointValue(H.x,H.y,H.z,0,o),this.setPointValue(H.x,H.y,H.z,5,o),this.setPointValue(H.x,H.y,H.z,N-5,o)),W.x=y.x-v.x,W.y=y.y-v.y,W.z=y.z-v.z,r.default.normalize(W,W);i.default.calculateIntersectionOfPlane(Y,W,y,m,H);null!=H&&(this.setPointValue(H.x,H.y,H.z,4,o),this.setPointValue(H.x,H.y,H.z,N-3,o),this.setPointValue(H.x,H.y,H.z,N-4,o))}return o}},{key:"setPointValue",value:function(t,e,n,a,r){r[a*=3]=t,r[a+1]=e,r[a+2]=n}},{key:"getPoint",value:function(t,e){t*=3;var n=r.default.TEMP_VECTORS[0];return n.x=e[t],n.y=e[t+1],n.z=e[t+2],n}},{key:"updateRectPoint",value:function(t,e,n,a){var r=(n*=18)+3,i=r+3;null!=t&&(a[r]=t.x,a[r+1]=t.y,a[r+2]=t.z),null!=e&&(a[i]=e.x,a[i+1]=e.y,a[i+2]=e.z,a[i+=3]=e.x,a[i+1]=e.y,a[i+2]=e.z)}},{key:"updateConnectPoints",value:function(t,e,n,a,o,s,l,h,f,c,d,y,v){var g=r.default.TEMP_VECTORS[0],x=p;x.x=e.x-t.x,x.y=e.y-t.y,x.z=e.z-t.z,r.default.normalize(x,x),r.default.normalize(c,c);var b=r.default.dot(c,x);if(!(b<0||(b=Math.abs(b),u.default.equals(b,1)))){var m=k;r.default.cross(m,c,d),r.default.normalize(m,m),i.default.calculateIntersectionOfPlane(m,x,e,o,P),null!=P&&(o.x=P.x,o.y=P.y,o.z=P.z),x.x=n.x-a.x,x.y=n.y-a.y,x.z=n.z-a.z,r.default.normalize(x,x),i.default.calculateIntersectionOfPlane(m,x,a,h,g),null!=g&&(h.x=g.x,h.y=g.y,h.z=g.z),this.updateRectPoint(P,g,f-1,y)}}},{key:"addPoint",value:function(t,e){e.push(t.x),e.push(t.y),e.push(t.z)}}]),t}();e.default=w},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=void 0,i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return a(t,null,[{key:"projection",value:function(t,e){var n=this.identity();return n[0]=2/t,n[4]=-2/e,n[6]=-1,n[7]=1,n[8]=1,n}},{key:"identity",value:function(t){return null==t?((t=new Float32Array(9))[0]=1,t[4]=1,t[8]=1):(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1),t}},{key:"translate",value:function(t,e,n){var a=void 0,r=void 0,i=void 0;return 3==arguments.length&&(i=t,this.identity(i),a=e,r=n),2==arguments.length&&(a=t,r=e,i=this.identity()),i[6]=a,i[7]=r,i}},{key:"rotate",value:function(t,e){var n=void 0,a=void 0;2==arguments.length&&(a=t,this.identity(a),n=e),1==arguments.length&&(n=t,a=this.identity());var r=Math.cos(n),i=Math.sin(n);return a[0]=r,a[1]=i,a[3]=-i,a[4]=r,a}},{key:"scale",value:function(t,e,n){var a=void 0,r=void 0,i=void 0;return 3==arguments.length&&(i=t,this.identity(i),a=e,r=n),2==arguments.length&&(a=t,r=e,i=this.identity()),i[0]=a,i[4]=r,i}},{key:"copy",value:function(t,e){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]}},{key:"multiplyWithVertex",value:function(e,n,a){var r=void 0,i=void 0,u=void 0;3==arguments.length&&(r=n,i=e,u=a),2==arguments.length&&(r=e,u=n),null==i&&(i=t.identity());var o=r[0],s=r[1],l=r[2],h=r[3],f=r[4],c=r[5],d=r[6],y=r[7],v=r[8],g=u[0],x=u[1],b=u[2];return null==b&&(b=1),i[0]=g*o+x*h+b*d,i[1]=g*s+x*f+b*y,i[2]=g*l+x*c+b*v,i}},{key:"multiply",value:function(t,e,n){var a=e[0],r=e[1],i=e[2],u=e[3],o=e[4],s=e[5],l=e[6],h=e[7],f=e[8],c=n[0],d=n[1],y=n[2],v=n[3],g=n[4],x=n[5],b=n[6],m=n[7],p=n[8];return t[0]=c*a+d*u+y*l,t[1]=c*r+d*o+y*h,t[2]=c*i+d*s+y*f,t[3]=v*a+g*u+x*l,t[4]=v*r+g*o+x*h,t[5]=v*i+g*s+x*f,t[6]=b*a+m*u+p*l,t[7]=b*r+m*o+p*h,t[8]=b*i+m*s+p*f,t}},{key:"TEMP_MAT3",get:function(){return null==r&&(r=[t.identity(),t.identity(),t.identity(),t.identity()]),r}}]),t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=u(n(20)),i=u(n(1));function u(t){return t&&t.__esModule?t:{default:t}}var o=Symbol("WebGL的program"),s=Symbol("转换矩阵变量可用的最大数量"),l=function(){function t(e,n,a,r,u,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.DEBUG_DRAW_COUNT=0,this.defaultTransformMatrix=i.default.identity(),this.orthoProjectionMatrix=i.default.identity(),this.perspectiveMatrix=i.default.identity(),r=r||0,a=a||e.getParameter(this.gl.MAX_TEXTURE_SIZE);var l=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS);n=n||Math.floor((l-4)/4),n=2,this[s]=n,this.textureManager=null,this.verticesData=null,this.fragmentData=null,this.transformMatrixData=null,this.canvasWidth=-1,this.canvasHeight=-1,this.lightPosition=new Float32Array(3),this.lightPosition[0]=e.canvas.clientWidth/2,this.lightPosition[1]=e.canvas.clientHeight/2,this.lightPosition[2]=0,this.projectionType=r,this.fov=u,this.init(),this.textureManager.maxHeight=a,this.textureManager.maxWidth=this.textureManager.maxHeight,o=o||!1,this.enableLight(o)}return a(t,[{key:"enableLight",value:function(t){var e=0;e=t?1:0,this.gl.uniform1f(this.shaderInformation.enableLight,e)}},{key:"clean",value:function(){this.DEBUG_DRAW_COUNT=0,this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"initRending",value:function(){var t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height)}},{key:"setUniformTransformMatrix",value:function(t,e){this.gl.uniformMatrix4fv(this.shaderInformation.transformMatrixArray[e],!1,t)}},{key:"prepareWebGLBuffer",value:function(){var t=this.gl,e=this.shaderInformation;t.enableVertexAttribArray(e.vertexAttribute),t.bindBuffer(t.ARRAY_BUFFER,e.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticesData.buffer,t.DYNAMIC_DRAW);var n=3,a=t.FLOAT,r=!1,i=32,u=0;t.vertexAttribPointer(e.vertexAttribute,n,a,r,i,u),a=t.FLOAT,n=3,u=16,r=!0,t.vertexAttribPointer(e.normalAttribute,n,a,r,i,u),t.enableVertexAttribArray(e.colorAttribute),t.enableVertexAttribArray(e.textureCoordAttribute),t.bindBuffer(t.ARRAY_BUFFER,e.fragmentBuffer),t.bufferData(t.ARRAY_BUFFER,this.fragmentData.buffer,t.DYNAMIC_DRAW),a=t.UNSIGNED_BYTE,i=this.fragmentData.singleDataByteLength,n=3,u=0,r=!1,t.vertexAttribPointer(e.colorAttribute,n,a,r,i,u),a=t.FLOAT,n=1,u=4,t.vertexAttribPointer(e.alphaAttribute,n,a,r,i,u),a=t.FLOAT,n=2,u=8,t.vertexAttribPointer(e.textureCoordAttribute,n,a,r,i,u),t.enableVertexAttribArray(e.transformMatrixIndex),t.bindBuffer(t.ARRAY_BUFFER,e.matrixIndexBuffer),t.bufferData(t.ARRAY_BUFFER,this.transformMatrixData.buffer,t.DYNAMIC_DRAW),a=t.FLOAT,n=1,u=0,i=4,t.vertexAttribPointer(e.transformMatrixIndex,n,a,r,i,u)}},{key:"executeRenderAction",value:function(t){this.prepareWebGLBuffer();for(var e=void 0,n=0,a=0,r=0;r<t.length;r++){var i=t[r];null==e&&(e=i),i.textureIndex!=e.textureIndex&&-1!=i.textureIndex&&-1!=e.textureIndex&&(this.renderVertices(n,a,e.textureIndex),e=i,n=a,a=0),-1==e.textureIndex&&-1!=i.textureIndex&&(e=i),a+=i.renderPointNumber}null!=e&&this.renderVertices(n,a,e.textureIndex)}},{key:"renderVertices",value:function(t,e,n){if(0!=e){var a=this.gl;this.initProjectionMatrix(),this.gl.uniform3f(this.shaderInformation.lightPosition,this.lightPosition[0],this.lightPosition[1],this.lightPosition[2]),this.configTexture(n),a.drawArrays(a.TRIANGLES,t,e),this.DEBUG_DRAW_COUNT++}}},{key:"initProjectionMatrix",value:function(){var t=this.gl;if(this.canvasHeight!=t.canvas.clientHeight&&this.canvasWidth!=t.canvas.clientWidth){var e=Math.tan(this.fov*Math.PI/180),n=-t.canvas.height/(2*e);i.default.identityMatrix(this.defaultTransformMatrix),i.default.translationMatrix(this.defaultTransformMatrix,0,0,n),t.uniformMatrix4fv(this.shaderInformation.transformMatrixArray[0],!1,this.defaultTransformMatrix);var a=void 0;if(0==this.projectionType)a=i.default.orthoProjection(0,0,t.canvas.width,t.canvas.height,1,Math.abs(2*n),this.orthoProjectionMatrix);else{var r=Math.atan2(t.canvas.clientHeight/2,Math.abs(n));a=i.default.perspective3(2*r,t.canvas.clientWidth,t.canvas.clientHeight,1,Math.abs(2*n),this.perspectiveMatrix)}t.uniformMatrix4fv(this.shaderInformation.perspectiveMatrix,!1,a),this.canvasHeight=t.canvas.clientHeight,this.canvasWidth=t.canvas.clientWidth}}},{key:"setLightPosition",value:function(t,e,n){this.lightPosition[0]=t,this.lightPosition[1]=e,this.lightPosition[2]=n}},{key:"configTexture",value:function(t){null==t&&(t=-1);var e=this.gl,n=this.shaderInformation;e.uniform1i(n.textureLocation,0);var a=void 0,r=void 0;-1==t?(a=n.blackTexture,r={width:1,height:1}):(a=this.textureManager.textureArray[t],r=this.textureManager.imageDataArray[t]),e.uniform2f(n.singleCanvas,r.width,r.height),e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,a)}},{key:"createShaderProgram",value:function(){var t=this.gl,e=this.loadShader(t.VERTEX_SHADER,this.getVertexShaderSource(this.maxTransformMatrixNum)),n=this.loadShader(t.FRAGMENT_SHADER,"\n  precision mediump float;\n  varying vec4 currentColor;\n  varying vec2 v_texcoord;\n  varying vec3 normal;\n  varying vec3 v_position;\n  uniform vec2 singleCanvas;\n  uniform vec3 u_lightPosition;\n  uniform float enableLight;\n  uniform sampler2D u_texture;\n  void main() {\n        vec2 coord = vec2(v_texcoord.x / singleCanvas.x , v_texcoord.y/singleCanvas.y);\n        vec4 color = currentColor;\n        vec3 r_normal = normalize(normal);    \n        vec3 forward = u_lightPosition - v_position;\n        vec3 lightLocation = normalize(forward);    \n        gl_FragColor = color * texture2D(u_texture,coord);\n        if(enableLight == 1.0){\n            gl_FragColor.rgb *= abs(dot(r_normal,lightLocation));\n        }\n  }\n  "),a=t.createProgram();return t.attachShader(a,e),t.attachShader(a,n),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)?(t.useProgram(a),a):(console.error("无法初始化Program: "+t.getProgramInfoLog(a)),t.deleteProgram(a),null)}},{key:"init",value:function(){this.gl;this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.disable(this.gl.DEPTH_TEST),this[o]=this.createShaderProgram();var t=this[o];this.shaderInformation=this.initShaderInformation(t),this.textureManager=new r.default(801,801,10,4)}},{key:"initShaderInformation",value:function(t){var e=this.gl,n=e.getAttribLocation(t,"u_texCoord");e.enableVertexAttribArray(n);var a=e.getAttribLocation(t,"a_position");e.enableVertexAttribArray(a);var r=e.getAttribLocation(t,"a_normal");e.enableVertexAttribArray(r);var i=e.getAttribLocation(t,"transform_matrix_index");e.enableVertexAttribArray(i);var u=e.getAttribLocation(t,"color");e.enableVertexAttribArray(u);var o=e.getAttribLocation(t,"alpha");e.enableVertexAttribArray(o);for(var s=e.getUniformLocation(t,"perspective_matrix"),l=new Array(this.maxTransformMatrixNum),h=0;h<l.length;h++)l[h]=e.getUniformLocation(t,"transform_matrix_array["+h+"]");var f=e.getUniformLocation(t,"singleCanvas"),c=e.getUniformLocation(t,"u_lightPosition"),d=e.getUniformLocation(t,"enableLight"),y=e.getUniformLocation(t,"u_texture"),v=e.createBuffer(),g=e.createBuffer(),x=e.createBuffer(),b=e.createTexture();e.bindTexture(e.TEXTURE_2D,b);var m=new Uint8Array([255,255,255,255]);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,m),e.bindTexture(e.TEXTURE_2D,null),{vertexAttribute:a,normalAttribute:r,colorAttribute:u,alphaAttribute:o,textureCoordAttribute:n,verticesBuffer:v,fragmentBuffer:x,matrixIndexBuffer:g,perspectiveMatrix:s,transformMatrixArray:l,transformMatrixIndex:i,singleCanvas:f,textureLocation:y,blackTexture:b,lightPosition:c,enableLight:d,webgl:e}}},{key:"loadShader",value:function(t,e){var n=this.gl,a=n.createShader(t);return n.shaderSource(a,e),n.compileShader(a),n.getShaderParameter(a,n.COMPILE_STATUS)?a:(console.error("着色器编译错误: "+n.getShaderInfoLog(a)),n.deleteShader(a),null)}},{key:"getVertexShaderSource",value:function(t){return" attribute vec3 color;\n     attribute vec4 a_position;\n     attribute vec3 a_normal;\n     attribute float alpha;\n     attribute vec2 u_texCoord;\n     varying vec3 v_position;\n     attribute float transform_matrix_index;\n     varying vec2 v_texcoord;\n     varying vec4 currentColor;\n     varying vec3 normal;\n     uniform mat4 perspective_matrix;\n     uniform mat4 transform_matrix_array["+t+"];\n     void main() {\n            normal = a_normal;\n            vec4 yuandian = vec4(0,0,0,1);\n            v_texcoord = u_texCoord;\n            vec4 new_position = transform_matrix_array[int(transform_matrix_index)] * a_position;\n            v_position = vec3(new_position.xyz);\n            vec4 finalPosition = perspective_matrix* new_position;\n            currentColor = vec4 (color.xyz/255.0,alpha);\n            gl_Position = finalPosition;\n    }"}},{key:"maxTransformMatrixNum",get:function(){return this[s]}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(21),u=(a=i)&&a.__esModule?a:{default:a};var o=Symbol("图片缓存"),s=Symbol("texture缓存"),l=function(){function t(e,n,a,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxWidth=e||1,this.maxHeight=n||1,this.maxTextureNum=a||1,this[o]=[],this[s]=[],this.imageDataArray=new Array(this.maxTextureNum),this.textureArray=new Array(this.maxTextureNum),this.singleTexture=void 0,this.lastImageData=void 0,this.space=r||3}return r(t,[{key:"getTexture",value:function(t,e,n){var a=this.imageCatch.indexOf(t);return-1==a?this.registerImageData(t,e,n):this[s][a]}},{key:"registerImageData",value:function(t,e,n){if(null!=t&&null!=t){null==n&&(n=!1);var a=0,r=0,i=t.width,o=t.height;if(i>this.maxWidth||o>this.maxHeight)throw new Error("图片大小超过了最大限制："+this.maxWidth+" x "+this.maxHeight);if(-1==this.imageCatch.indexOf(t)){var l=new u.default,h=l.getContext("2d");h.clearRect(0,0,l.width,l.height);for(var f=-1,c=0;c<this.imageDataArray.length;c++){var d=this.imageDataArray[c];if(null==d)d={imageData:void 0,startX:0,startY:0,width:0,height:0},this.imageDataArray[c]=d,l.width=t.width,l.height=t.height+1,a=0,r=1,h.fillStyle="#ffffff",h.fillRect(0,0,1,1),h.drawImage(t,0,1),d.imageData=h.getImageData(0,0,l.width,l.height),d.startX=l.width+this.space,d.startY=1,d.width=l.width,d.height=l.height;else{var y=t.width,v=t.height;if(a=d.startX,r=d.startY,a+y>this.maxWidth?(a=0,r=d.height+this.space,l.width=Math.max(d.width,y),l.height=r+v,console.log("换行")):(l.width=Math.max(d.width,a+y),l.height=Math.max(d.height,r+v),console.log("不换行")),r+v>this.maxHeight){console.log("图片超过贴图内存最大尺寸");continue}h.putImageData(d.imageData,0,0),h.drawImage(t,a,r),d.imageData=h.getImageData(0,0,l.width,l.height),d.startX=a+y+this.space,d.startY=r,d.width=l.width,d.height=l.height}f=c;break}if(-1!=f){this.imageCatch.push(t);var g={x:a,y:r,width:i,height:o,index:f};return n&&this.createTexture(e,f,l),this[s].push(g),g}}}else console.error("Image can not be null")}},{key:"createAllTexture",value:function(t){if(null!=t)for(var e=new u.default,n=(e.getContext("2d"),0);n<this.textureArray.length;n++)this.createTexture(t,n,e)}},{key:"createTexture",value:function(e,n,a){if(null!=e&&null!=n&&-1!=n){null==a&&(a=new u.default);var r=a.getContext("2d"),i=this.textureArray[n],o=this.imageDataArray[n];null!=o&&(a.width=o.width,a.height=o.height,r.putImageData(o.imageData,0,0),null==i&&(i=e.createTexture(),this.textureArray[n]=i),e.bindTexture(e.TEXTURE_2D,i),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t.isPOT(a.width)&&t.isPOT(a.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null))}}},{key:"imageCatch",get:function(){return this[o]}}],[{key:"isPOT",value:function(t){return t>0&&0==(t-1&t)}}]),t}();e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.createElement("canvas")}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}();var r=Symbol("当前顶点游标位置"),i=Symbol("Float32的typed数组"),u=Symbol("存储顶点数组的buffer"),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this[u]=new ArrayBuffer(4*e*2*4),this[i]=new Float32Array(this[u]),this[r]=0}return a(t,[{key:"init",value:function(){this[r]=0}},{key:"setVerticesData",value:function(t,e,n,a,r,u,o){4*(o*=8)>=this.totalByteLength&&this.resize(2*this.totalByteLength),this[i][o]=t,this[i][o+1]=e,this[i][o+2]=n,this[i][o+4]=a,this[i][o+5]=r,this[i][o+6]=u}},{key:"getVerticesData",value:function(t){return t*=8,[this[i][t],this[i][t+1],this[i][t+2],this[i][t+4],this[i][t+5],this[i][t+6]]}},{key:"getVerticesPositionData",value:function(t){return t*=8,[this[i][t],this[i][t+1],this[i][t+2]]}},{key:"getVerticesNormalData",value:function(t){return t*=8,[this[i][t+4],this[i][t+5],this[i][t+6]]}},{key:"addVerticesData",value:function(t,e,n,a,i,u){var o=this[r];this.setVerticesData(t,e,n,a,i,u,o),this[r]++}},{key:"resize",value:function(t){if(t<this.totalByteLength)throw Error("new length should not less than old length");var e=this[u];this[u]=new ArrayBuffer(t);var n=new Uint8Array(e);new Uint8Array(this[u]).set(n,0),this[i]=new Float32Array(this[u])}},{key:"singleDataByteLength",get:function(){return 32}},{key:"totalByteLength",get:function(){return this[u].byteLength}},{key:"buffer",get:function(){return this[u]}},{key:"currentIndex",get:function(){return this[r]}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=(i(n(5)),i(n(0)));function i(t){return t&&t.__esModule?t:{default:t}}var u=16,o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.buffer=new ArrayBuffer(e*u),this.dv=new DataView(this.buffer),this.currentIndex=0,this.isLittleEndian=r.default.littleEndian}return a(t,[{key:"setFragmentData",value:function(t,e,n,a,r,i,u,o){o*=this.singleDataByteLength,this.dv.setUint8(o,t),this.dv.setUint8(o+1,e),this.dv.setUint8(o+2,n),o+=4,this.dv.setFloat32(o,a,this.isLittleEndian),this.dv.setFloat32(o+4,r,this.isLittleEndian),this.dv.setFloat32(o+8,i,this.isLittleEndian)}},{key:"init",value:function(){this.currentIndex=0}},{key:"resize",value:function(t){if(t<this.totalByteLength)throw Error("new length should not less than old length");var e=this.buffer;this.buffer=new ArrayBuffer(t);var n=new Uint8Array(e);new Uint8Array(this.buffer).set(n,0),this.dv=new DataView(this.buffer)}},{key:"addFragmentData",value:function(t,e,n,a,r,i,u){var o=this.currentIndex;o*this.singleDataByteLength>=this.totalByteLength&&this.resize(2*this.totalByteLength),this.setFragmentData(t,e,n,a,r,i,u,o),this.currentIndex++}},{key:"totalByteLength",get:function(){return this.buffer.byteLength}},{key:"singleDataByteLength",get:function(){return u}}]),t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,r=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),i=n(5),u=(a=i)&&a.__esModule?a:{default:a};var o=4,s=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),r(e,[{key:"setMatrixIndex",value:function(t,e){this.setData(t,e)}},{key:"addMatrixIndex",value:function(t){var e=this.currentIndex;e*this.singleDataByteLength>=this.totalByteLength&&this.resize(2*this.totalByteLength),this.setMatrixIndex(t,e),this.currentIndex++}},{key:"getMatrixIndex",value:function(t){return this.getData(t)}}]),e}();e.default=s}]).default});