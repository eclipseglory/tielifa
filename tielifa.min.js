!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WebGL2D=e():(t.tielifa=t.tielifa||{},t.tielifa.WebGL2D=e())}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(1),u=(n=a)&&n.__esModule?n:{default:n};var s=void 0,o=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"perspective2",value:function(t,e,r,n,i,a){return[2*i/(r-t),0,0,0,0,2*i/(e-n),0,0,(r+t)/(r-t),(n+e)/(e-n),(-i-a)/(a-i),-1,0,0,-i*a*2/(a-i),0]}},{key:"perspective3",value:function(e,r,n,i,a){var u=this.perspective(e,r/n,i,a),s=t.TEMP_MAT4[0];return t.translationMatrix(s,-r/2,-n/2,0),t.multiply(u,u,s),u}},{key:"perspective",value:function(t,e,r,n){var i=Math.tan(.5*Math.PI-.5*t);u.default.equals(i,1)&&(i=1);var a=1/(r-n),s=this.identity();return s[0]=i/e,s[5]=-i,s[10]=(r+n)*a,s[11]=-1,s[14]=r*n*a*2,s}},{key:"orthoProjection",value:function(t,e,r,n,i,a){return new Float32Array([2/(r-t),0,0,0,0,2/(e-n),0,0,0,0,2/(i-a),0,(t+r)/(t-r),(n+e)/(n-e),(i+a)/(i-a),1])}},{key:"copy",value:function(t,e){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]}},{key:"equals",value:function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],o=t[5],l=t[6],h=t[7],f=t[8],c=t[9],d=t[10],v=t[11],y=t[12],g=t[13],b=t[14],x=t[15],p=e[0],m=e[1],k=e[2],M=e[3],w=e[4],P=e[5],T=e[6],S=e[7],I=e[8],A=e[9],_=e[10],E=e[11],D=e[12],N=e[13],C=e[14],L=e[15];return Math.abs(r-p)<=u.default.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(n-m)<=u.default.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-k)<=u.default.EPSILON*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(a-M)<=u.default.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-w)<=u.default.EPSILON*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-P)<=u.default.EPSILON*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(l-T)<=u.default.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(h-S)<=u.default.EPSILON.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-I)<=u.default.EPSILON*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(c-A)<=u.default.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(d-_)<=u.default.EPSILON*Math.max(1,Math.abs(d),Math.abs(_))&&Math.abs(v-E)<=u.default.EPSILON*Math.max(1,Math.abs(v),Math.abs(E))&&Math.abs(y-D)<=u.default.EPSILON*Math.max(1,Math.abs(y),Math.abs(D))&&Math.abs(g-N)<=u.default.EPSILON*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(b-C)<=u.default.EPSILON*Math.max(1,Math.abs(b),Math.abs(C))&&Math.abs(x-L)<=u.default.EPSILON*Math.max(1,Math.abs(x),Math.abs(L))}},{key:"exactEquals",value:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}},{key:"projection",value:function(t,e,r){var n=this.identity();return n[0]=2/t,n[5]=-2/e,n[10]=2/r,n[12]=-1,n[13]=1,n[15]=1,n}},{key:"identity",value:function(){var t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}},{key:"identityMatrix",value:function(t){var e=t;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1}},{key:"translationMatrix",value:function(t,e,r,n){var i=t;i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e,i[13]=r,i[14]=n,i[15]=1}},{key:"translation",value:function(t,e,r){var n=this.identity();return n[12]=t,n[13]=e,n[14]=r,n}},{key:"rotationZMatrix",value:function(t,e){var r=t;r[2]=0,r[3]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1;var n=Math.cos(e),i=Math.sin(e);r[0]=n,r[1]=i,r[4]=-i,r[5]=n}},{key:"rotationZ",value:function(t){var e=Math.cos(t),r=Math.sin(t),n=this.identity();return n[0]=e,n[1]=r,n[4]=-r,n[5]=e,n}},{key:"rotationXMatrix",value:function(t,e){var r=t;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[7]=0,r[8]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1;var n=Math.cos(e),i=Math.sin(e);r[5]=n,r[6]=i,r[9]=-i,r[10]=n}},{key:"rotationX",value:function(t){var e=Math.cos(t),r=Math.sin(t),n=this.identity();return n[5]=e,n[6]=r,n[9]=-r,n[10]=e,n}},{key:"rotationYMatrix",value:function(t,e){var r=t;r[1]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1;var n=Math.cos(e),i=Math.sin(e);r[0]=n,r[2]=-i,r[8]=i,r[10]=n}},{key:"rotationY",value:function(t){var e=Math.cos(t),r=Math.sin(t),n=this.identity();return n[0]=e,n[2]=-r,n[8]=r,n[10]=e,n}},{key:"scalingMatrix",value:function(t,e,r,n){var i=t;i[0]=e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1}},{key:"scaling",value:function(t,e,r){var n=this.identity();return n[0]=t,n[5]=e,n[10]=r,n}},{key:"multiplyWithVertex",value:function(t,e){var r=t[0],n=t[1],i=t[2],a=t[3],u=t[4],s=t[5],o=t[6],l=t[7],h=t[8],f=t[9],c=t[10],d=t[11],v=t[12],y=t[13],g=t[14],b=t[15],x=e[0],p=e[1],m=e[2],k=e[3];return null==m&&(m=0),null==k&&(k=1),[x*r+p*u+m*h+k*v,x*n+p*s+m*f+k*y,x*i+p*o+m*c+k*g,x*a+p*l+m*d+k*b]}},{key:"multiply",value:function(t,e,r){var n=e[0],i=e[1],a=e[2],u=e[3],s=e[4],o=e[5],l=e[6],h=e[7],f=e[8],c=e[9],d=e[10],v=e[11],y=e[12],g=e[13],b=e[14],x=e[15],p=r[0],m=r[1],k=r[2],M=r[3];return t[0]=p*n+m*s+k*f+M*y,t[1]=p*i+m*o+k*c+M*g,t[2]=p*a+m*l+k*d+M*b,t[3]=p*u+m*h+k*v+M*x,p=r[4],m=r[5],k=r[6],M=r[7],t[4]=p*n+m*s+k*f+M*y,t[5]=p*i+m*o+k*c+M*g,t[6]=p*a+m*l+k*d+M*b,t[7]=p*u+m*h+k*v+M*x,p=r[8],m=r[9],k=r[10],M=r[11],t[8]=p*n+m*s+k*f+M*y,t[9]=p*i+m*o+k*c+M*g,t[10]=p*a+m*l+k*d+M*b,t[11]=p*u+m*h+k*v+M*x,p=r[12],m=r[13],k=r[14],M=r[15],t[12]=p*n+m*s+k*f+M*y,t[13]=p*i+m*o+k*c+M*g,t[14]=p*a+m*l+k*d+M*b,t[15]=p*u+m*h+k*v+M*x,t}},{key:"TEMP_MAT4",get:function(){return null==s&&(s=[t.identity(),t.identity(),t.identity(),t.identity()]),s}},{key:"EPSILON",get:function(){return u.default.EPSILON}}]),t}();e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=2*Math.PI,a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instance=null}return n(t,null,[{key:"equals",value:function(t,e){return Math.abs(t-e)<=1e-5}},{key:"getDistance",value:function(t,e){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}},{key:"clamp",value:function(t,e,r){return t>r?r:t<e?e:t}},{key:"getInsance",value:function(){return null==this.instance&&(this.instance=new t),this.instance}},{key:"overlaps",value:function(t,e){var r=t,n=e;return r.left<=n.right&&r.right>=n.left&&r.bottom>=n.top&&r.top<=n.bottom}},{key:"isHit",value:function(e,r){var n=!1,i=e.left,a=e.top;return t.isInTheRect(i,a,r)&&(n=!0),i=e.left,a=e.top+e.height,t.isInTheRect(i,a,r)&&(n=!0),i=e.left+e.width,a=e.top,t.isInTheRect(i,a,r)&&(n=!0),i=e.left+e.width,a=e.top+e.height,t.isInTheRect(i,a,r)&&(n=!0),n||(i=r.left,a=r.top,t.isInTheRect(i,a,e)&&(n=!0),i=r.left,a=r.top+r.height,t.isInTheRect(i,a,e)&&(n=!0),i=r.left+r.width,a=r.top,t.isInTheRect(i,a,e)&&(n=!0),i=r.left+r.width,a=r.top+r.height,t.isInTheRect(i,a,e)&&(n=!0)),n}},{key:"isInTheRect",value:function(t,e,r){var n=r.left,i=r.top,a=r.width,u=r.height;return t>n&&t<n+a&&e>i&&e<i+u}},{key:"PI2",get:function(){return i}},{key:"EPSILON",get:function(){return 1e-5}}]),t}();e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=19200,a=Symbol("当前buffer数据所在的字节索引"),u=Symbol("单个数据块字节大小"),s=Symbol("ArrayBuffer的数据存放结构"),o=Symbol("当前所在结构中的索引"),l=void 0,h={},f=0,c=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0===r&&(r=i);var n=t.getFromCache(r);this.buffer=null,this.dv=null,null==n?this.buffer=new ArrayBuffer(r):(this.buffer=n.buffer,this.dv=n.dv),null!=this.dv&&this.dv instanceof DataView||(this.dv=new DataView(this.buffer)),this[s]=e,t.initDataStructure(e,this),this[o]=0,this[a]=0}return n(t,[{key:"recycle",value:function(){return t.putInCache(this)}},{key:"flush",value:function(t){if(null!=t)t!=this.buffer.byteLength&&(this.buffer=new ArrayBuffer(t),this.dv=new DataView(this.buffer));else for(var e=new Uint8Array(this.buffer),r=0;r<this.buffer.byteLength;r++)e[r]=0;this[o]=0,this[a]=0}},{key:"resetButDontFlush",value:function(){this[o]=0,this[a]=0}},{key:"getByteSize",value:function(t){switch(t){case 8:return 8;case 1:case 5:case 2:return 1;case 6:case 3:return 2;case 4:case 7:case 0:return 4}return 0}},{key:"put",value:function(e){if(e instanceof Array)for(var r=0;r<e.length;r++)this.put(e[r]);else if(void 0===this.dataStructure)this.resizeBuffer(4),this.dv.setFloat32(this.currentIndex,e,t.littleEndian),this[a]+=this.singleDataFragmentByteSize;else{var n=this.dataStructure[this[o]],i=this.getByteSize(n.type);this.resizeBuffer(i),this.setValue(n.type,e);var u=this.currentIndex%this.singleDataFragmentByteSize;if(0==u)return void(this[o]=0);u>n.endByte&&this[o]++}}},{key:"get",value:function(e,r){var n=t.littleEndian;switch(r){case 8:return this.dv.getFloat64(e,n);case 1:return this.dv.getUint8(e);case 5:return this.dv.getInt8(e);case 2:return this.dv.getUint8(e);case 6:return this.dv.getInt16(e,n);case 3:return this.dv.getUint16(e,n);case 4:return this.dv.getFloat32(e,n);case 7:return this.dv.getInt32(e,n);case 0:return this.dv.getUint32(e,n)}}},{key:"setValue",value:function(e,r){var n=t.littleEndian,i=this.currentIndex;switch(e){case 8:this.dv.setFloat64(i,r,n),this[a]+=8;break;case 1:this.dv.setUint8(i,r),this[a]+=1;break;case 5:this.dv.setInt8(i,r),this[a]+=1;break;case 2:this.dv.setUint8(i,r),this[a]+=1;break;case 6:this.dv.setInt16(i,r,n),this[a]+=2;break;case 3:this.dv.setUint16(i,r,n),this[a]+=2;break;case 4:this.dv.setFloat32(i,r,n),this[a]+=4;break;case 7:this.dv.setInt32(i,r,n),this[a]+=4;break;case 0:this.dv.setUint32(i,r,n),this[a]+=4}}},{key:"addLength",value:function(t){var e=new Uint8Array(this.buffer),r=new Uint8Array(new ArrayBuffer(this.buffer.byteLength+t));r.set(e),this.buffer=r.buffer,this.dv=new DataView(this.buffer)}},{key:"resizeBuffer",value:function(t){void 0===t&&(t=this.singleDataFragmentByteSize),this[a]+t>this.buffer.byteLength&&this.addLength(t)}},{key:"clean",value:function(){this.buffer=new ArrayBuffer(this.buffer.byteLength),this.dv=new DataView(this.buffer),this[a]=0,this[o]=0}},{key:"getVertex",value:function(t){if(t>this.currentIndex||t<0)throw new Error("Index Error");return[this.dv.getFloat32(t),this.dv.getFloat32(t+4),this.dv.getFloat32(t+8)]}},{key:"modifyVertex",value:function(e,r){var n=t.littleEndian;if(r>this.currentIndex||r<0)throw new Error("Index Error");this.dv.setFloat32(r,e[0],n),this.dv.setFloat32(r+4,e[1],n),this.dv.setFloat32(r+8,e[2],n)}},{key:"putVertexData",value:function(t,e,r,n){this.putVertexData2(t[0],t[1],t[2],e,r,n)}},{key:"putVertexData2",value:function(e,r,n,i,u,s){this.resizeBuffer(this.singleDataFragmentByteSize);var o=t.littleEndian,l=this.currentIndex;this.dv.setFloat32(l,e,o),this.dv.setFloat32(l+4,r,o),this.dv.setFloat32(l+8,n,o),this.dv.setFloat32(l+16,0,o),this.dv.setUint8(l+20,i[0]),this.dv.setUint8(l+21,i[1]),this.dv.setUint8(l+22,i[2]),this.dv.setUint8(l+23,Math.floor(100*u)),this.dv.setFloat32(l+24,s[0],o),this.dv.setFloat32(l+28,s[1],o),this[a]+=this.singleDataFragmentByteSize}},{key:"dataStructure",get:function(){return this[s]}},{key:"currentIndex",get:function(){return this[a]}},{key:"bufferByteLength",get:function(){return this.buffer.byteLength}},{key:"singleDataFragmentByteSize",get:function(){return this[u]}},{key:"vertexCount",get:function(){return this.currentIndex/this.singleDataFragmentByteSize}},{key:"length",get:function(){return this.buffer.byteLength}}],[{key:"putInCache",value:function(t){var e=t.buffer,r=t.dv;if(f+e.byteLength>16777216)return!1;f+=e.byteLength;var n=h[e.byteLength];return null==n&&(n=[],h[e.byteLength]=n),n.push({buffer:e,dv:r}),!0}},{key:"getFromCache",value:function(t){var e=h[t];if(null==e||0==e.length)return null;var r=e.pop();return f-=r.buffer.byteLength,r}},{key:"initDataStructure",value:function(t,e){if(null==t)return console.warn("DataStructure没有指定，默认单个float32数据进行存放。DataStructure必须是一个数组，其内部结构为 [...{type:type,count:count,byteSize:size},...]"),e[u]=4,void(e[s]=void 0);if(!(t instanceof Array))return console.warn("DataStructure必须是一个数组，其内部结构为 [...{type:type,count:count,byteSize:size},...]"),e[u]=4,void(e[s]=void 0);for(var r=0,n=0,i=0,a=0;a<t.length;a++){var o=t[a];o.byteSize=e.getByteSize(o.type)*o.count,o.startByte=n,i=n+o.byteSize,o.endByte=i-1,r+=o.byteSize,n=i}e[u]=r}},{key:"arrayBufferCache",get:function(){return h}},{key:"TYPE_FLOAT32",get:function(){return 4}},{key:"TYPE_FLOAT64",get:function(){return 8}},{key:"TYPE_UINT8",get:function(){return 2}},{key:"TYPE_UINT16",get:function(){return 3}},{key:"TYPE_UINT32",get:function(){return 0}},{key:"TYPE_INT8",get:function(){return 5}},{key:"TYPE_INT16",get:function(){return 6}},{key:"TYPE_INT32",get:function(){return 7}},{key:"TYPE_UINT8CLAMPED",get:function(){return 1}},{key:"littleEndian",get:function(){if(void 0===l){var t=new ArrayBuffer(2),e=new Uint8Array(t),r=new Uint16Array(t);e[0]=170,e[1]=187,48042===r[0]&&(l=!0),43707===r[0]&&(l=!1)}return l}}]),t}();e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=u(r(12)),a=u(r(13));function u(t){return t&&t.__esModule?t:{default:t}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.vertexData=null,this.textureIndex=-1}return n(t,[{key:"getVertexData",value:function(t){return null==this.vertexData?this.vertexData=new i.default(this.type,t):this.vertexData.resize(t),this.vertexData}},{key:"collectVertexData",value:function(t,e,r,n){1!=this.type?0!=this.type||this.collectVertexDataForStroke(t,e,r,n):this.collectVertexDataForFill(t,e,r,n)}},{key:"collectVertexDataForStroke",value:function(t,e,r,n){for(var i=0,a=0;a<t.length;a++)for(var u=t[a],s=0;s<u.subPathNumber;s++){var o=u.subPathArray[s],l=o.pointsNumber;if(!(l<2)){var h=l-1;o.isClosed&&h++,i+=h}}for(var f=this.getVertexData(2*i),c=0;c<t.length;c++)for(var d=t[c],v=0;v<d.subPathNumber;v++){var y=d.subPathArray[v],g=y.pointsNumber;if(!(g<2)){var b=g-1;y.isClosed&&b++;for(var x=0;x<b;x++){var p=x;f.addMatrixIdData(y.getPointMatrixData(p)),f.addVertexData2(y.getPointX(p),y.getPointY(p),y.getPointZ(p),e,r,n);var m=(x+1)%g;f.addMatrixIdData(y.getPointMatrixData(m)),f.addVertexData2(y.getPointX(m),y.getPointY(m),y.getPointZ(m),e,r,n)}}}}},{key:"collectVertexDataForFill",value:function(t,e,r,n){for(var i=0,u=[],s=0;s<t.length;s++){var o=t[s];if(0!=o.subPathNumber)for(var l=0;l<o.subPathNumber;l++){var h=o.subPathArray[l];if(!(h.pointsNumber<3)){var f=void 0,c=h.pointsCoordinateArray,d=h.pointsNumber;if(3*d==c.length)f=a.default.earcut(c,null,3);else{var v=c.slice(0,3*d);f=a.default.earcut(v,null,3)}i+=f.length,u.push(f)}}}var y=this.getVertexData(i);if(0!=i)for(var g=0,b=0;b<t.length;b++){var x=t[b];if(0!=x.subPathNumber)for(var p=0;p<x.subPathNumber;p++,g++){var m=x.subPathArray[p];if(!(m.pointsNumber<3))for(var k=u[g],M=0;M<k.length;M++){var w=k[M];y.addMatrixIdData(m.getPointMatrixData(w)),n[0]instanceof Array?y.addVertexData2(m.getPointX(w),m.getPointY(w),m.getPointZ(w),e,r,n[w]):y.addVertexData2(m.getPointX(w),m.getPointY(w),m.getPointZ(w),e,r,n)}}}}},{key:"organizeVertexForFill",value:function(t,e,r,n){var i=void 0,u=t.pointsCoordinateArray,s=t.pointsNumber;if(3*s==u.length)i=a.default.earcut(u,null,3);else{var o=u.slice(0,3*s);i=a.default.earcut(o,null,3)}for(var l=this.getVertexData(i.length),h=0;h<i.length;h++){var f=i[h];l.addMatrixIdData(t.getPointMatrixData(f)),n[0]instanceof Array?l.addVertexData2(t.getPointX(f),t.getPointY(f),t.getPointZ(f),e,r,n[f]):l.addVertexData2(t.getPointX(f),t.getPointY(f),t.getPointZ(f),e,r,n)}}}],[{key:"ACTION_STROKE",get:function(){return 0}},{key:"ACTION_FILL",get:function(){return 1}}]),t}();e.default=s},function(t,e,r){t.exports=r(5)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=d(r(6)),a=d(r(7)),u=d(r(8)),s=d(r(9)),o=d(r(10)),l=d(r(3)),h=d(r(15)),f=d(r(1)),c=d(r(0));d(r(2));function d(t){return t&&t.__esModule?t:{default:t}}var v=Symbol("对应的Canvas"),y=Symbol("状态栈"),g=Symbol("状态数组，记录全部状态"),b=Symbol("路径列表"),x=Symbol("绘制动作List"),p=Symbol("子Path缓存"),m=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null!=r&&null!=r||(r=[]),this[v]=e,null==e||null==e)throw new Error("canvas can not be undefined or null");if(this.gl=e.getContext("webgl"),null==this.gl)throw new Error("Current canvas doesnt support WebGL");var n=r.FOV||20,i=Math.tan(n*Math.PI/180);this.defaultDepth=-e.height/(2*i),this[y]=[],this[g]=[],this[b]=[],this[x]=[],this[p]=[],this.webglRender=new h.default(this.gl,r.maxTransformNum,r.maxTextureSize,r.projectionType,this.defaultDepth),this.translate(0,0,this.defaultDepth)}return n(t,[{key:"clean",value:function(){this[b].length=0,this.webglRender.clean()}},{key:"clearRect",value:function(t,e,r,n){this.clean()}},{key:"beginPath",value:function(){this.currentPath.clean()}},{key:"closePath",value:function(){var t=this.currentPath;if(0!=t.subPathNumber){var e=t.lastSubPath;e.close();var r=e.getPointX(0),n=e.getPointX(0),i=e.getPointX(0),a=e.getPointStateId(0),u=e.getPointMatrixId(0),o=new s.default;o.addPoint(r,n,i,a,u),t.addSubPath(o)}}},{key:"lineTo",value:function(t,e,r){null==r&&(r=0);var n=this.currentContextState,i=this.currentPath.lastSubPath,a=n.transformMatrix.matrix,u=c.default.multiplyWithVertex(a,[t,e,r,1]);i.addPoint(u[0],u[1],u[2],n.id,n.transformMatrixId),n.fireDirty()}},{key:"moveTo",value:function(t,e,r){null==r&&(r=0);this.currentContextState;var n=this.currentPath,i=new s.default;n.addSubPath(i),this.lineTo(t,e,r)}},{key:"rect",value:function(t,e,r,n,i){null==i&&(i=0),this.moveTo(t,e,i),this.lineTo(t+r,e,i),this.lineTo(t+r,e+n,i),this.lineTo(t,e+n,i),this.closePath()}},{key:"ellipse",value:function(t,e,r,n,i,a,u,o){if(r<0||n<0)throw new Error("半径必须不小于0. Radius should not be smaller than zero. BanJing BiXu BuXiaoYu Ling");if(0!=r&&0!=n){null==o&&(o=!1);var l=this.currentPath.lastSubPath;null==l&&(l=new s.default,this.currentPath.addSubPath(l)),((a=b(a))>(u=b(u))&&!o||a<u&&o)&&((a<0||u<0)&&((u-=2*Math.PI)==a||Math.abs(u-a)<=f.default.EPSILON)&&(u-=2*Math.PI),(a>0||u>0)&&((u+=2*Math.PI)==a||Math.abs(u-a)<=f.default.EPSILON)&&(u+=2*Math.PI));var h=Math.max(r,n),c=2*Math.asin(1/h),d=0;o&&(c*=-1);for(var v=a;Math.abs(v)<Math.abs(u);v+=c,d++){var y=x(t,e,r,n,v);this.lineTo(y.x,y.y)}var g=x(t,e,r,n,u);this.lineTo(g.x,g.y)}function b(t){var e=2*Math.PI,r=Math.floor(Math.abs(t/e))+1;return Math.abs(t)>e&&r++,t<0&&!o&&(t+=r*e),t>0&&o&&(t-=r*e),t}function x(t,e,r,n,a){var u=Math.cos(a),s=Math.sin(a),o=s/u,l=Math.sqrt(n*n*r*r/(n*n+r*r*o*o)),h=o*l;if(u*l<0&&(l*=-1),s*h<0&&(h*=-1),l+=t,h+=e,0!=i){var f=(l-t)*Math.cos(i)-(h-e)*Math.sin(i)+t,c=(h-e)*Math.cos(i)+(l-t)*Math.sin(i)+e;l=f,h=c}return{x:l,y:h}}}},{key:"arc",value:function(t,e,r,n,i,a){this.ellipse(t,e,r,r,0,n,i,a)}},{key:"save",value:function(){var t=this.currentContextState.clone();this[y].push(t),this[g].push(t),t.id=this[g].length-1}},{key:"restore",value:function(){0!=this[y].length&&this[y].pop()}},{key:"translate",value:function(t,e,r){this.currentContextState.translate(t,e,r)}},{key:"rotate",value:function(t){this.currentContextState.rotateZ(t)}},{key:"rotateX",value:function(t){this.currentContextState.rotateX(t)}},{key:"rotateY",value:function(t){this.currentContextState.rotateY(t)}},{key:"scale",value:function(t,e,r){this.currentContextState.scale(t,e,r)}},{key:"drawImage",value:function(t,e,r,n,i,a,u,s,o,h){h=h||0;var f=this.webglRender.textureManager.getTexture(t,this.gl,!0),c=new l.default(l.default.ACTION_FILL);c.textureIndex=f.index;var d=void 0,v=void 0,y=void 0,g=void 0,p=void 0,m=void 0,k=void 0,M=void 0;3==arguments.length&&(d=e,v=r,y=e+t.width,g=r+t.height,p=f.x,k=f.x+f.width,m=f.y,M=f.y+f.height),4==arguments.length&&(d=e,v=r,y=e+t.width,g=r+t.height,p=f.x,k=f.x+f.width,m=f.y,M=f.y+f.height,h=n),5==arguments.length&&(d=e,v=r,y=e+n,g=r+i,p=f.x,k=f.x+f.width,m=f.y,M=f.y+f.height),6==arguments.length&&(d=e,v=r,y=e+n,g=r+i,p=f.x,k=f.x+f.width,m=f.y,M=f.y+f.height,h=a),9==arguments.length&&(d=a,v=u,y=a+s,g=u+o,p=f.x+e,k=f.x+e+n,m=f.y+r,M=f.y+r+i),this.beginPath(),this.rect(d,v,y-d,g-v,h);var w=this.currentContextState.globalAlpha,P=this[b];this[x].push(c);var T=new Array(4);T[0]=[p,m],T[1]=[k,m],T[2]=[k,M],T[3]=[p,M];c.collectVertexData(P,[255,255,255],w,T)}},{key:"fill",value:function(){var t=o.default.getInstance().convertStringToColor(this.currentContextState.fillStyle),e=this.currentContextState.globalAlpha,r=this[b],n=new l.default(l.default.ACTION_FILL);this[x].push(n),n.collectVertexData(r,t,e*t[3],[0,0])}},{key:"fillRect",value:function(t,e,r,n){this.beginPath(),this.rect(t,e,r,n),this.fill()}},{key:"stroke",value:function(){var t=o.default.getInstance().convertStringToColor(this.currentContextState.strokeStyle),e=this.currentContextState.globalAlpha,r=this[b],n=new l.default(l.default.ACTION_STROKE);this[x].push(n),n.collectVertexData(r,t,e*t[3],[0,0])}},{key:"turnOnLight",value:function(){this.webglRender.enableLight(!0)}},{key:"turnOffLight",value:function(){this.webglRender.enableLight(!1)}},{key:"setLightPosition",value:function(t,e,r){this.webglRender.setLightPosition(t,e,r)}},{key:"fillOrStroke",value:function(t,e){null!=t&&(this.fillStyle=t,this.fill()),null!=e&&(this.strokeStyle=e,this.stroke())}},{key:"drawRectangle",value:function(t,e,r,n,i,a){this.save(),this.beginPath(),this.rect(t,e,r,n),this.fillOrStroke(i,a),this.restore()}},{key:"drawEllipse",value:function(t,e,r,n,i,a,u){this.save(),this.beginPath(),this.ellipse(t,e,r,n,u,0,f.default.PI2,!1),this.closePath(),this.fillOrStroke(i,a),this.restore()}},{key:"drawCircle",value:function(t,e,r,n,i){this.drawEllipse(t,e,r,r,n,i,0)}},{key:"draw",value:function(){this.webglRender.initRending(),this.webglRender.executeRenderAction(this[x],this[g]),this.collectBufferForRecycle(),this[x]=[],this[g]=[]}},{key:"collectBufferForRecycle",value:function(){for(var t=0;t<this[x].length;t++){var e=this[x][t].vertexData;if(!e.dataBuffer.recycle())break;if(!e.matrixIndexBuffer.recycle())break}}},{key:"currentContextState",get:function(){if(0==this[y].length){var t=new i.default(new a.default);this[y].push(t),this[g].push(t),t.id=this[g].length-1}return this[y][this[y].length-1]}},{key:"currentPath",get:function(){return 0==this[b].length&&this[b].push(new u.default),this[b][this[b].length-1]}},{key:"canvas",get:function(){return this[v]}},{key:"strokeStyle",set:function(t){this.currentContextState.strokeStyle=t},get:function(){return this.currentContextState.strokeStyle}},{key:"fillStyle",set:function(t){this.currentContextState.fillStyle=t},get:function(){return this.currentContextState.fillStyle}},{key:"globalAlpha",set:function(t){this.currentContextState.globalAlpha=t},get:function(){return this.currentContextState.globalAlpha}}]),t}();e.default=m},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=u(r(0)),a=u(r(1));function u(t){return t&&t.__esModule?t:{default:t}}Symbol("变换矩阵");var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.canvasDrawingStyle=e,this.matrixIndex=0,this.fillStyle="#000000",this.strokeStyle="#000000",this.globalAlpha=1,this.id=-1,this.matrixArray=[],this.matrixArray.push(i.default.identity()),this.dirty=!1}return n(t,[{key:"fireDirty",value:function(){this.dirty=!0}},{key:"setTransformMatrix",value:function(t){var e=this.transformMatrix.matrix;i.default.copy(t,e)}},{key:"checkDirty",value:function(){if(this.dirty){var t=i.default.identity(),e=this.transformMatrix.matrix;i.default.copy(e,t),this.matrixArray.push(t),this.dirty=!1}}},{key:"applyTransform",value:function(t){this.checkDirty();var e=this.transformMatrix.matrix;i.default.multiply(e,e,t)}},{key:"translate",value:function(t,e,r){if(void 0===r&&(r=0),!(a.default.equals(t,0)&&a.default.equals(e,0)&&a.default.equals(r,0))){var n=i.default.TEMP_MAT4[0];i.default.translationMatrix(n,t,e,r),this.applyTransform(n)}}},{key:"rotateZ",value:function(t){if(!a.default.equals(t,0)){var e=i.default.TEMP_MAT4[0];i.default.rotationZMatrix(e,t),this.applyTransform(e)}}},{key:"rotateX",value:function(t){if(!a.default.equals(t,0)){var e=i.default.TEMP_MAT4[0];i.default.rotationXMatrix(e,t),this.applyTransform(e)}}},{key:"rotateY",value:function(t){if(!a.default.equals(t,0)){var e=i.default.TEMP_MAT4[0];i.default.rotationYMatrix(e,t),this.applyTransform(e)}}},{key:"scale",value:function(t,e,r){if(void 0===r&&(r=1),!(a.default.equals(t,1)&&a.default.equals(e,1)&&a.default.equals(r,1))){var n=i.default.TEMP_MAT4[0];i.default.scalingMatrix(n,t,e,r),this.applyTransform(n)}}},{key:"clone",value:function(){var e=new t(this.canvasDrawingStyle.clone());return e.fillStyle=this.fillStyle,e.strokeStyle=this.strokeStyle,e.globalAlpha=this.globalAlpha,e.matrixIndex=this.matrixIndex,e.setTransformMatrix(this.transformMatrix.matrix),e}},{key:"transformMatrixId",get:function(){return this.matrixArray.length-1}},{key:"transformMatrix",get:function(){var t=this.matrixArray.length-1;return{matrix:this.matrixArray[t],id:t}}}]),t}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=Symbol("线宽度,默认1"),a=Symbol('线连接样式，"butt", "round", "square" (默认: "butt")'),u=Symbol('线连接样式，"round", "bevel", "miter" (默认: "miter")'),s=Symbol("默认10"),o=Symbol('文字字体大小等，默认"10px sans-serif"'),l=Symbol('文字对齐,"start", "end", "left", "right", "center" (默认: "start")'),h=Symbol('文字纵向对齐，"top", "hanging", "middle", "alphabetic", "ideographic", "bottom" (默认: "alphabetic")'),f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this[i]=1,this[a]="butt",this[u]="miter",this[s]=10,this.font="10px sans-serif",this.textAlign="start",this.textBaseline="alphabetic"}return n(t,[{key:"clone",value:function(){var e=new t;return e.textBaseline=this.textBaseline,e.textAlign=this.textAlign,e.font=this.font,e.lineCap=this.lineCap,e.lineJoin=this.lineJoin,e.lineWidth=this.lineWidth,e}},{key:"lineWidth",get:function(){return this[i]},set:function(t){this[i]=t}},{key:"lineCap",get:function(){return this[a]},set:function(t){this[a]=t}},{key:"lineJoin",get:function(){return this[u]},set:function(t){this[u]=t}},{key:"miterLimit",get:function(){return this[s]},set:function(t){this[s]=t}},{key:"font",get:function(){return this[o]},set:function(t){this[o]=t}},{key:"textAlign",get:function(){return this[l]},set:function(t){this[l]=t}},{key:"textBaseline",get:function(){return this[h]},set:function(t){this[h]=t}}]),t}();e.default=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subPathArray=[]}return n(t,[{key:"addSubPath",value:function(t){this.subPathArray.push(t)}},{key:"clean",value:function(){this.subPathArray.length=0}},{key:"subPathNumber",get:function(){return this.subPathArray.length}},{key:"lastSubPath",get:function(){if(0!=this.subPathNumber)return this.subPathArray[this.subPathNumber-1]}}]),t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=Symbol("当前的点所在的索引位置"),a=Symbol("点的坐标值数组,每三个为一组，分别是x,y,z"),u=Symbol("点的坐标值数组，每两个为一组，分别是stateId,matrixId"),s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pointsArray=[],this[i]=0,this[a]=[],this[u]=[],null!=e&&null!=e&&this.pushPoint(e),this.isClosed=!1}return n(t,[{key:"init",value:function(){this.isClosed=!1,this[i]=0}},{key:"getPointX",value:function(t){return t*=3,this[a][t]}},{key:"getPointY",value:function(t){return t*=3,this[a][t+1]}},{key:"getPointZ",value:function(t){return t*=3,this[a][t+2]}},{key:"getPointStateId",value:function(t){return t*=2,this[u][t]}},{key:"getPointMatrixId",value:function(t){return t*=2,this[u][t+1]}},{key:"getPointMatrixData",value:function(t){return[this.getPointStateId(t),this.getPointMatrixId(t)]}},{key:"addPoint",value:function(t,e,r,n,s){n=n||0,s=s||0;var o=this[i];3*o>=this[a].length?(this[a].push(t),this[a].push(e),this[a].push(r)):(this[a][o]=t,this[a][o+1]=e,this[a][o+2]=r),2*o>=this[u].length?(this[u].push(n),this[u].push(s)):(this[u][o]=n,this[u][o+1]=s),this[i]++}},{key:"close",value:function(){this.isClosed=!0}},{key:"getPoint",value:function(t){return this.pointsArray[t]}},{key:"clean",value:function(){this.pointsArray.length=0,this.isClosed=!1}},{key:"pushPoint",value:function(t){this.pointsArray.push(t)}},{key:"pointsCoordinateArray",get:function(){return this[a]}},{key:"pointsNumber",get:function(){return this[i]}}]),t}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(11),u=(n=a)&&n.__esModule?n:{default:n};var s=void 0,o=function(){function t(){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s)return s;s=this,this.colorMap={}}return i(t,[{key:"convertStringToColor",value:function(e){var r=this.colorMap[e];return null!=r?r:(e=e.toLowerCase(),t.isRGBAString(e)?this.rgba2vec(e):t.isHSLAString(e)?this.hsla2vet3(e):this.getVec(e,e,1))}},{key:"hsla2vet3",value:function(t){var e=t,r=this.colorMap[e];if(null!=r)return r;var n=1;if(3==(t=(t=t.match(new RegExp(",","g")))||[]).length){var i=(t=e).lastIndexOf(","),a=t.lastIndexOf(")"),u=t.substring(i+1,a);n=parseFloat(u),t=t.substring(0,i),t+=")"}else t=e;t=t.replace("a","");var s=w3color(t);return s.valid?(r=[s.r,s.g,s.b,n],this.colorMap[e]=r,r):[0,0,0,1]}},{key:"rgba2vec",value:function(t){var e=t,r=this.colorMap[e];if(null!=r)return r;var n=1;if(3==(t=(t=t.match(new RegExp(",","g")))||[]).length){var i=(t=e).lastIndexOf(","),a=t.lastIndexOf(")"),u=t.substring(i+1,a);n=parseFloat(u),t=t.substring(0,i),t+=")"}else t=e;return t=t.replace("a",""),this.getVec(t,e,n)}},{key:"getVec",value:function(t,e,r){var n=this.colorMap[e];if(null!=n)return n;var i=new u.default(t);if(i.valid){var a=i.toRgb(),s=[a.r,a.g,a.b,r];return null==this.colorMap[e]&&(this.colorMap[e]=s),s}return[0,0,0,1]}}],[{key:"getInstance",value:function(){return s||(s=new t),s}},{key:"isRGBAString",value:function(t){return!(!t||0!=t.indexOf("rgba"))}},{key:"isHSLAString",value:function(t){return!(!t||0!=t.indexOf("hsla"))}}]),t}();e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var u=function(){function t(e,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this instanceof t?"object"==(void 0===e?"undefined":n(e))?e:(this.attachValues(t.toColorObject(e)),void(r&&(r.style.backgroundColor=this.toRgbString()))):new t(e,r)}return a(t,[{key:"attachValues",value:function(t){this.red=t.red,this.green=t.green,this.blue=t.blue,this.hue=t.hue,this.sat=t.sat,this.lightness=t.lightness,this.whiteness=t.whiteness,this.blackness=t.blackness,this.cyan=t.cyan,this.magenta=t.magenta,this.yellow=t.yellow,this.black=t.black,this.ncol=t.ncol,this.opacity=t.opacity,this.valid=t.valid}},{key:"toRgbString",value:function(){return"rgb("+this.red+", "+this.green+", "+this.blue+")"}},{key:"toRgbaString",value:function(){return"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.opacity+")"}},{key:"toHwbString",value:function(){return"hwb("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%)"}},{key:"toHwbStringDecimal",value:function(){return"hwb("+this.hue+", "+this.whiteness+", "+this.blackness+")"}},{key:"toHwbaString",value:function(){return"hwba("+this.hue+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity+")"}},{key:"toHslString",value:function(){return"hsl("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%)"}},{key:"toHslStringDecimal",value:function(){return"hsl("+this.hue+", "+this.sat+", "+this.lightness+")"}},{key:"toHslaString",value:function(){return"hsla("+this.hue+", "+Math.round(100*this.sat)+"%, "+Math.round(100*this.lightness)+"%, "+this.opacity+")"}},{key:"toCmykString",value:function(){return"cmyk("+Math.round(100*this.cyan)+"%, "+Math.round(100*this.magenta)+"%, "+Math.round(100*this.yellow)+"%, "+Math.round(100*this.black)+"%)"}},{key:"toCmykStringDecimal",value:function(){return"cmyk("+this.cyan+", "+this.magenta+", "+this.yellow+", "+this.black+")"}},{key:"toNcolString",value:function(){return this.ncol+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%"}},{key:"toNcolStringDecimal",value:function(){return this.ncol+", "+this.whiteness+", "+this.blackness}},{key:"toNcolaString",value:function(){return this.ncol+", "+Math.round(100*this.whiteness)+"%, "+Math.round(100*this.blackness)+"%, "+this.opacity}},{key:"toName",value:function(){var t,e,r,n=getColorArr("hexs");for(i=0;i<n.length;i++)if(t=parseInt(n[i].substr(0,2),16),e=parseInt(n[i].substr(2,2),16),r=parseInt(n[i].substr(4,2),16),this.red==t&&this.green==e&&this.blue==r)return getColorArr("names")[i];return""}},{key:"toHexString",value:function(){return"#"+toHex(this.red)+toHex(this.green)+toHex(this.blue)}},{key:"toRgb",value:function(){return{r:this.red,g:this.green,b:this.blue,a:this.opacity}}},{key:"toHsl",value:function(){return{h:this.hue,s:this.sat,l:this.lightness,a:this.opacity}}},{key:"toHwb",value:function(){return{h:this.hue,w:this.whiteness,b:this.blackness,a:this.opacity}}},{key:"toCmyk",value:function(){return{c:this.cyan,m:this.magenta,y:this.yellow,k:this.black,a:this.opacity}}},{key:"toNcol",value:function(){return{ncol:this.ncol,w:this.whiteness,b:this.blackness,a:this.opacity}}},{key:"isDark",value:function(t){var e=t||128;return(299*this.red+587*this.green+114*this.blue)/1e3<e}},{key:"saturate",value:function(t){var e,r,n;e=t/100||.1,this.sat+=e,this.sat>1&&(this.sat=1),r=hslToRgb(this.hue,this.sat,this.lightness),n=colorObject(r,this.opacity,this.hue,this.sat),this.attachValues(n)}},{key:"desaturate",value:function(t){var e,r,n;e=t/100||.1,this.sat-=e,this.sat<0&&(this.sat=0),r=hslToRgb(this.hue,this.sat,this.lightness),n=colorObject(r,this.opacity,this.hue,this.sat),this.attachValues(n)}},{key:"lighter",value:function(t){var e,r,n;e=t/100||.1,this.lightness+=e,this.lightness>1&&(this.lightness=1),r=hslToRgb(this.hue,this.sat,this.lightness),n=colorObject(r,this.opacity,this.hue,this.sat),this.attachValues(n)}},{key:"darker",value:function(t){var e,r,n;e=t/100||.1,this.lightness-=e,this.lightness<0&&(this.lightness=0),r=hslToRgb(this.hue,this.sat,this.lightness),n=colorObject(r,this.opacity,this.hue,this.sat),this.attachValues(n)}}],[{key:"w3color",value:function(t){function e(e,r){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){return this instanceof w3color?"object"==(void 0===t?"undefined":n(t))?t:(this.attachValues(toColorObject(t)),void(e&&(e.style.backgroundColor=this.toRgbString()))):new w3color(t,e)})},{key:"toColorObject",value:function(t){var e,r,n,i,a,u,s,o,l,h,f,c=[],d=[],v=[];if(e=(t=this.w3trim(t.toLowerCase())).substr(0,1).toUpperCase(),r=t.substr(1),o=1,"R"!=e&&"Y"!=e&&"G"!=e&&"C"!=e&&"B"!=e&&"M"!=e&&"W"!=e||isNaN(r)||6==t.length&&-1==t.indexOf(",")||(t="ncol("+t+")"),3==t.length||6==t.length||isNaN(t)||(t="ncol("+t+")"),t.indexOf(",")>0&&-1==t.indexOf("(")&&(t="ncol("+t+")"),"rgb"==t.substr(0,3)||"hsl"==t.substr(0,3)||"hwb"==t.substr(0,3)||"ncol"==t.substr(0,4)||"cmyk"==t.substr(0,4)){if("ncol"==t.substr(0,4)?(4==t.split(",").length&&-1==t.indexOf("ncola")&&(t=t.replace("ncol","ncola")),n="ncol",t=t.substr(4)):"cmyk"==t.substr(0,4)?(n="cmyk",t=t.substr(4)):(n=t.substr(0,3),t=t.substr(3)),i=3,u=!1,"a"==t.substr(0,1).toLowerCase()?(i=4,u=!0,t=t.substr(1)):"cmyk"==n&&(i=4,5==t.split(",").length&&(i=5,u=!0)),c=(t=(t=t.replace("(","")).replace(")","")).split(","),"rgb"==n){if(c.length!=i)return this.emptyObject();for(a=0;a<i;a++){if(""!=c[a]&&" "!=c[a]||(c[a]="0"),c[a].indexOf("%")>-1&&(c[a]=c[a].replace("%",""),c[a]=Number(c[a]/100),a<3&&(c[a]=Math.round(255*c[a]))),isNaN(c[a]))return this.emptyObject();parseInt(c[a])>255&&(c[a]=255),a<3&&(c[a]=parseInt(c[a])),3==a&&Number(c[a])>1&&(c[a]=1)}f={r:c[0],g:c[1],b:c[2]},1==u&&(o=Number(c[3]))}if("hsl"==n||"hwb"==n||"ncol"==n){for(;c.length<i;)c.push("0");for("hsl"!=n&&"hwb"!=n||parseInt(c[0])>=360&&(c[0]=0),a=1;a<i;a++){if(c[a].indexOf("%")>-1){if(c[a]=c[a].replace("%",""),c[a]=Number(c[a]),isNaN(c[a]))return this.emptyObject();c[a]=c[a]/100}else c[a]=Number(c[a]);Number(c[a])>1&&(c[a]=1),Number(c[a])<0&&(c[a]=0)}"hsl"==n&&(f=this.hslToRgb(c[0],c[1],c[2]),l=Number(c[0]),h=Number(c[1])),"hwb"==n&&(f=this.hwbToRgb(c[0],c[1],c[2])),"ncol"==n&&(f=this.ncolToRgb(c[0],c[1],c[2])),1==u&&(o=Number(c[3]))}if("cmyk"==n){for(;c.length<i;)c.push("0");for(a=0;a<i;a++){if(c[a].indexOf("%")>-1){if(c[a]=c[a].replace("%",""),c[a]=Number(c[a]),isNaN(c[a]))return this.emptyObject();c[a]=c[a]/100}else c[a]=Number(c[a]);Number(c[a])>1&&(c[a]=1),Number(c[a])<0&&(c[a]=0)}f=this.cmykToRgb(c[0],c[1],c[2],c[3]),1==u&&(o=Number(c[4]))}}else if("ncs"==t.substr(0,3))f=this.ncsToRgb(t);else{for(s=!1,d=this.getColorArr("names"),a=0;a<d.length;a++)if(t.toLowerCase()==d[a].toLowerCase()){v=this.getColorArr("hexs"),s=!0,f={r:parseInt(v[a].substr(0,2),16),g:parseInt(v[a].substr(2,2),16),b:parseInt(v[a].substr(4,2),16)};break}if(0==s){for(3==(t=t.replace("#","")).length&&(t=t.substr(0,1)+t.substr(0,1)+t.substr(1,1)+t.substr(1,1)+t.substr(2,1)+t.substr(2,1)),a=0;a<t.length;a++)if(!this.isHex(t.substr(a,1)))return this.emptyObject();for(c[0]=parseInt(t.substr(0,2),16),c[1]=parseInt(t.substr(2,2),16),c[2]=parseInt(t.substr(4,2),16),a=0;a<3;a++)if(isNaN(c[a]))return this.emptyObject();f={r:c[0],g:c[1],b:c[2]}}}return this.colorObject(f,o,l,h)}},{key:"colorObject",value:function(t,e,r,n){var i,a,u,s,o,l,h;return t?(e||(e=1),i=this.rgbToHsl(t.r,t.g,t.b),a=this.rgbToHwb(t.r,t.g,t.b),u=this.rgbToCmyk(t.r,t.g,t.b),l=r||i.h,h=n||i.s,s=this.hueToNcol(l),o={red:t.r,green:t.g,blue:t.b,hue:l,sat:h,lightness:i.l,whiteness:a.w,blackness:a.b,cyan:u.c,magenta:u.m,yellow:u.y,black:u.k,ncol:s,opacity:e,valid:!0},o=this.roundDecimals(o)):this.emptyObject()}},{key:"emptyObject",value:function(){return{red:0,green:0,blue:0,hue:0,sat:0,lightness:0,whiteness:0,blackness:0,cyan:0,magenta:0,yellow:0,black:0,ncol:"R",opacity:1,valid:!1}}},{key:"getColorArr",value:function(t){return"names"==t?["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"]:"hexs"==t?["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"]:void 0}},{key:"roundDecimals",value:function(t){return t.red=Number(t.red.toFixed(0)),t.green=Number(t.green.toFixed(0)),t.blue=Number(t.blue.toFixed(0)),t.hue=Number(t.hue.toFixed(0)),t.sat=Number(t.sat.toFixed(2)),t.lightness=Number(t.lightness.toFixed(2)),t.whiteness=Number(t.whiteness.toFixed(2)),t.blackness=Number(t.blackness.toFixed(2)),t.cyan=Number(t.cyan.toFixed(2)),t.magenta=Number(t.magenta.toFixed(2)),t.yellow=Number(t.yellow.toFixed(2)),t.black=Number(t.black.toFixed(2)),t.ncol=t.ncol.substr(0,1)+Math.round(Number(t.ncol.substr(1))),t.opacity=Number(t.opacity.toFixed(2)),t}},{key:"hslToRgb",value:function(t,e,r){var n,i;return t/=60,n=2*r-(i=r<=.5?r*(e+1):r+e-r*e),{r:255*hueToRgb(n,i,t+2),g:255*hueToRgb(n,i,t),b:255*hueToRgb(n,i,t-2)}}},{key:"hueToRgb",value:function(t,e,r){return r<0&&(r+=6),r>=6&&(r-=6),r<1?(e-t)*r+t:r<3?e:r<4?(e-t)*(4-r)+t:t}},{key:"hwbToRgb",value:function(t,e,r){var n,i,a,u=[];for(i=hslToRgb(t,1,.5),u[0]=i.r/255,u[1]=i.g/255,u[2]=i.b/255,(a=e+r)>1&&(e=Number((e/a).toFixed(2)),r=Number((r/a).toFixed(2))),n=0;n<3;n++)u[n]*=1-e-r,u[n]+=e,u[n]=Number(255*u[n]);return{r:u[0],g:u[1],b:u[2]}}},{key:"cmykToRgb",value:function(t,e,r,n){return{r:255-255*Math.min(1,t*(1-n)+n),g:255-255*Math.min(1,e*(1-n)+n),b:255-255*Math.min(1,r*(1-n)+n)}}},{key:"ncolToRgb",value:function(t,e,r){var n,i,a;if(a=t,isNaN(t.substr(0,1))){if(n=t.substr(0,1).toUpperCase(),""==(i=t.substr(1))&&(i=0),i=Number(i),isNaN(i))return!1;"R"==n&&(a=0+.6*i),"Y"==n&&(a=60+.6*i),"G"==n&&(a=120+.6*i),"C"==n&&(a=180+.6*i),"B"==n&&(a=240+.6*i),"M"==n&&(a=300+.6*i),"W"==n&&(a=0,e=1-i/100,r=i/100)}return hwbToRgb(a,e,r)}},{key:"hueToNcol",value:function(t){for(;t>=360;)t-=360;return t<60?"R"+t/.6:t<120?"Y"+(t-60)/.6:t<180?"G"+(t-120)/.6:t<240?"C"+(t-180)/.6:t<300?"B"+(t-240)/.6:t<360?"M"+(t-300)/.6:void 0}},{key:"ncsToRgb",value:function(t){var e,r,n,i,a,u,s,o,l,h,f,c,d,v,y,g,b;if(-1==(t=(t=(t=(t=(t=w3trim(t).toUpperCase()).replace("(","")).replace(")","")).replace("NCS","NCS ")).replace(/  /g," ")).indexOf("NCS")&&(t="NCS "+t),null===(t=t.match(/^(?:NCS|NCS\sS)\s(\d{2})(\d{2})-(N|[A-Z])(\d{2})?([A-Z])?$/)))return!1;if(e=parseInt(t[1],10),r=parseInt(t[2],10),"N"!=(n=t[3])&&"Y"!=n&&"R"!=n&&"B"!=n&&"G"!=n)return!1;if(i=parseInt(t[4],10)||0,"N"!==n){a=1.05*e-5.25,u=r,"Y"===n&&i<=60?l=1:"Y"===n&&i>60||"R"===n&&i<=80?(s="Y"===n?i-60:i+40,l=(Math.sqrt(14884-Math.pow(s,2))-22)/100):"R"===n&&i>80||"B"===n?l=0:"G"===n&&(s=i-170,l=(Math.sqrt(33800-Math.pow(s,2))-70)/100),"Y"===n&&i<=80?o=0:"Y"===n&&i>80||"R"===n&&i<=60?(s="Y"===n?i-80+20.5:i+20+20.5,o=(104-Math.sqrt(11236-Math.pow(s,2)))/100):"R"===n&&i>60||"B"===n&&i<=80?(s="R"===n?i-60-60:i+40-60,o=(Math.sqrt(1e4-Math.pow(s,2))-10)/100):"B"===n&&i>80||"G"===n&&i<=40?(s="B"===n?i-80-131:i+20-131,o=(122-Math.sqrt(19881-Math.pow(s,2)))/100):"G"===n&&i>40&&(o=0);var x=void 0;"Y"===n?x=(85-.85*i)/100:"R"===n&&i<=60?x=0:"R"===n&&i>60?(s=i-60+35,x=(67.5-Math.sqrt(5776-Math.pow(s,2)))/100):"B"===n&&i<=60?(s=1*i-68.5,x=(6.5+Math.sqrt(7044.5-Math.pow(s,2)))/100):"B"===n&&i>60||"G"===n&&i<=60?x=.9:"G"===n&&i>60&&(x=(90-1/8*(s=i-60))/100),c=((s=(l+x+o)/3)-o)*(100-u)/100+o,d=1/((h=(s-l)*(100-u)/100+l)>(f=(s-x)*(100-u)/100+x)&&h>c?h:f>h&&f>c?f:c>h&&c>f?c:(h+f+c)/3),(y=parseInt(h*d*(100-a)/100*255,10))>255&&(y=255),(g=parseInt(f*d*(100-a)/100*255,10))>255&&(g=255),(b=parseInt(c*d*(100-a)/100*255,10))>255&&(b=255),y<0&&(y=0),g<0&&(g=0),b<0&&(b=0)}else(v=parseInt(255*(1-e/100),10))>255&&(v=255),v<0&&(v=0),y=v,g=v,b=v;return{r:y,g:g,b:b}}},{key:"rgbToHsl",value:function(t,e,r){var n,i,a,u,s,o,l=[];for(l[0]=t/255,l[1]=e/255,l[2]=r/255,n=l[0],i=l[0],s=0,a=0;a<l.length-1;a++)l[a+1]<=n&&(n=l[a+1]),l[a+1]>=i&&(i=l[a+1],s=a+1);return 0==s&&(o=(l[1]-l[2])/(i-n)),1==s&&(o=2+(l[2]-l[0])/(i-n)),2==s&&(o=4+(l[0]-l[1])/(i-n)),isNaN(o)&&(o=0),(o*=60)<0&&(o+=360),u=(n+i)/2,{h:o,s:n==i?0:u<.5?(i-n)/(i+n):(i-n)/(2-i-n),l:u}}},{key:"rgbToHwb",value:function(t,e,r){t/=255,e/=255,r/=255;var n=Math.max(t,e,r),i=Math.min(t,e,r),a=n-i;return{h:0==a?0:t==n?(e-r)/a%6*360:e==n?((r-t)/a+2)%6*360:((t-e)/a+4)%6*360,w:i,b:1-n}}},{key:"rgbToCmyk",value:function(t,e,r){var n,i,a,u;return t/=255,e/=255,r/=255,1==(u=1-Math.max(t,e,r))?(n=0,i=0,a=0):(n=(1-t-u)/(1-u),i=(1-e-u)/(1-u),a=(1-r-u)/(1-u)),{c:n,m:i,y:a,k:u}}},{key:"toHex",value:function(t){for(var e=t.toString(16);e.length<2;)e="0"+e;return e}},{key:"cl",value:function(t){console.log(t)}},{key:"w3trim",value:function(t){return t.replace(/^\s+|\s+$/g,"")}},{key:"isHex",value:function(t){return"0123456789ABCDEFabcdef".indexOf(t)>-1}}]),t}();e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(2),u=(n=a)&&n.__esModule?n:{default:n};var s=[{type:u.default.TYPE_FLOAT32,count:3},{type:u.default.TYPE_FLOAT32,count:2},{type:u.default.TYPE_UINT8,count:4},{type:u.default.TYPE_FLOAT32,count:2}],o=32,l=[{type:u.default.TYPE_FLOAT32,count:1}],h=4,f=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.dataBuffer=new u.default(s,r*o),this.matrixIndexBuffer=new u.default(l,r*h),this.matrixIdArray=[]}return i(t,[{key:"resize",value:function(t){this.dataBuffer.addLength(t*o),this.matrixIndexBuffer.addLength(t*h)}},{key:"addVertexData",value:function(t,e,r,n){this.addVertexData2(t[0],t[1],t[2],e,r,n)}},{key:"addVertexData2",value:function(t,e,r,n,i,a){this.dataBuffer.putVertexData2(t,e,r,n,i,a)}},{key:"addMatrixIdData",value:function(t){this.matrixIdArray.push(t)}},{key:"getMatrixIdData",value:function(t){return this.matrixIdArray[t]}},{key:"getContextStateIndex",value:function(t){return this.matrixIdArray[t][0]}},{key:"getMatrixIndex",value:function(t){return this.matrixIdArray[t][1]}},{key:"putMatrixId",value:function(t){this.matrixIndexBuffer.put(t)}},{key:"vertexNumber",get:function(){return this.bufferSize/o}},{key:"bufferSize",get:function(){return this.dataBuffer.currentIndex}}],[{key:"VERTEX_BYTE_SIZE",get:function(){return o}},{key:"TYPE_FILL",get:function(){return 0}},{key:"TYPE_STROKE",get:function(){return 1}}]),t}();e.default=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(14),u=(n=a)&&n.__esModule?n:{default:n};var s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,null,[{key:"earcut",value:function(t,e,r){r=r||2;var n=e&&e.length,i=n?e[0]*r:t.length,a=this.linkedList(t,0,i,r,!0),u=[];if(!a||a.next===a.prev)return u;var s=void 0,o=void 0,l=void 0,h=void 0,f=void 0,c=void 0,d=void 0;if(n&&(a=this.eliminateHoles(t,e,a,r)),t.length>80*r){s=l=t[0],o=h=t[1];for(var v=r;v<i;v+=r)(f=t[v])<s&&(s=f),(c=t[v+1])<o&&(o=c),f>l&&(l=f),c>h&&(h=c);d=0!==(d=Math.max(l-s,h-o))?1/d:0}return this.earcutLinked(a,u,r,s,o,d),u}},{key:"linkedList",value:function(e,r,n,i,a){var u,s;if(a===t.signedArea(e,r,n,i)>0)for(u=r;u<n;u+=i)s=this.insertNode(u,e[u],e[u+1],s);else for(u=n-i;u>=r;u-=i)s=this.insertNode(u,e[u],e[u+1],s);return s&&t.equals(s,s.next)&&(this.removeNode(s),s=s.next),s}},{key:"filterPoints",value:function(e,r){if(!e)return e;r||(r=e);var n,i=e;do{if(n=!1,i.steiner||!t.equals(i,i.next)&&0!==t.area(i.prev,i,i.next))i=i.next;else{if(this.removeNode(i),(i=r=i.prev)===i.next)break;n=!0}}while(n||i!==r);return r}},{key:"earcutLinked",value:function(t,e,r,n,i,a,u){if(t){!u&&a&&this.indexCurve(t,n,i,a);for(var s,o,l=t;t.prev!==t.next;)if(s=t.prev,o=t.next,a?this.isEarHashed(t,n,i,a):this.isEar(t))e.push(s.i/r),e.push(t.i/r),e.push(o.i/r),this.removeNode(t),t=o.next,l=o.next;else if((t=o)===l){u?1===u?(t=this.cureLocalIntersections(t,e,r),this.earcutLinked(t,e,r,n,i,a,2)):2===u&&this.splitEarcut(t,e,r,n,i,a):this.earcutLinked(this.filterPoints(t),e,r,n,i,a,1);break}}}},{key:"isEar",value:function(e){var r=e.prev,n=e,i=e.next;if(this.area(r,n,i)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(this.pointInTriangle(r.x,r.y,n.x,n.y,i.x,i.y,a.x,a.y)&&t.area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}},{key:"isEarHashed",value:function(e,r,n,i){var a=e.prev,u=e,s=e.next;if(this.area(a,u,s)>=0)return!1;for(var o=a.x<u.x?a.x<s.x?a.x:s.x:u.x<s.x?u.x:s.x,l=a.y<u.y?a.y<s.y?a.y:s.y:u.y<s.y?u.y:s.y,h=a.x>u.x?a.x>s.x?a.x:s.x:u.x>s.x?u.x:s.x,f=a.y>u.y?a.y>s.y?a.y:s.y:u.y>s.y?u.y:s.y,c=this.zOrder(o,l,r,n,i),d=this.zOrder(h,f,r,n,i),v=e.prevZ,y=e.nextZ;v&&v.z>=c&&y&&y.z<=d;){if(v!==e.prev&&v!==e.next&&this.pointInTriangle(a.x,a.y,u.x,u.y,s.x,s.y,v.x,v.y)&&t.area(v.prev,v,v.next)>=0)return!1;if(v=v.prevZ,y!==e.prev&&y!==e.next&&this.pointInTriangle(a.x,a.y,u.x,u.y,s.x,s.y,y.x,y.y)&&t.area(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;v&&v.z>=c;){if(v!==e.prev&&v!==e.next&&this.pointInTriangle(a.x,a.y,u.x,u.y,s.x,s.y,v.x,v.y)&&t.area(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=d;){if(y!==e.prev&&y!==e.next&&this.pointInTriangle(a.x,a.y,u.x,u.y,s.x,s.y,y.x,y.y)&&t.area(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}},{key:"cureLocalIntersections",value:function(e,r,n){var i=e;do{var a=i.prev,u=i.next.next;!t.equals(a,u)&&this.intersects(a,i,i.next,u)&&this.locallyInside(a,u)&&this.locallyInside(u,a)&&(r.push(a.i/n),r.push(i.i/n),r.push(u.i/n),this.removeNode(i),this.removeNode(i.next),i=e=u),i=i.next}while(i!==e);return i}},{key:"splitEarcut",value:function(t,e,r,n,i,a){var u=t;do{for(var s=u.next.next;s!==u.prev;){if(u.i!==s.i&&this.isValidDiagonal(u,s)){var o=this.splitPolygon(u,s);return u=this.filterPoints(u,u.next),o=this.filterPoints(o,o.next),this.earcutLinked(u,e,r,n,i,a),void this.earcutLinked(o,e,r,n,i,a)}s=s.next}u=u.next}while(u!==t)}},{key:"eliminateHoles",value:function(t,e,r,n){var i,a,u,s,o,l=[];for(i=0,a=e.length;i<a;i++)u=e[i]*n,s=i<a-1?e[i+1]*n:t.length,(o=this.linkedList(t,u,s,n,!1))===o.next&&(o.steiner=!0),l.push(this.getLeftmost(o));for(l.sort(this.compareX),i=0;i<l.length;i++)this.eliminateHole(l[i],r),r=this.filterPoints(r,r.next);return r}},{key:"compareX",value:function(t,e){return t.x-e.x}},{key:"eliminateHole",value:function(t,e){if(e=this.findHoleBridge(t,e)){var r=this.splitPolygon(e,t);this.filterPoints(r,r.next)}}},{key:"findHoleBridge",value:function(t,e){var r,n=e,i=t.x,a=t.y,u=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>u){if(u=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===u)return r.prev;var o,l=r,h=r.x,f=r.y,c=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=h&&i!==n.x&&this.pointInTriangle(a<f?i:u,a,h,f,a<f?u:i,a,n.x,n.y)&&((o=Math.abs(a-n.y)/(i-n.x))<c||o===c&&n.x>r.x)&&this.locallyInside(n,t)&&(r=n,c=o),n=n.next;return r}},{key:"indexCurve",value:function(t,e,r,n){var i=t;do{null===i.z&&(i.z=this.zOrder(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,this.sortLinked(i)}},{key:"sortLinked",value:function(t){var e,r,n,i,a,u,s,o,l=1;do{for(r=t,t=null,a=null,u=0;r;){for(u++,n=r,s=0,e=0;e<l&&(s++,n=n.nextZ);e++);for(o=l;s>0||o>0&&n;)0!==s&&(0===o||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,o--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(u>1);return t}},{key:"zOrder",value:function(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}},{key:"getLeftmost",value:function(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}},{key:"pointInTriangle",value:function(t,e,r,n,i,a,u,s){return(i-u)*(e-s)-(t-u)*(a-s)>=0&&(t-u)*(n-s)-(r-u)*(e-s)>=0&&(r-u)*(a-s)-(i-u)*(n-s)>=0}},{key:"isValidDiagonal",value:function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!this.intersectsPolygon(t,e)&&this.locallyInside(t,e)&&this.locallyInside(e,t)&&this.middleInside(t,e)}},{key:"area",value:function(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}},{key:"equals",value:function(t,e){return t.x===e.x&&t.y===e.y}},{key:"intersects",value:function(e,r,n,i){return!!(t.equals(e,r)&&t.equals(n,i)||t.equals(e,i)&&t.equals(n,r))||t.area(e,r,n)>0!=t.area(e,r,i)>0&&t.area(n,i,e)>0!=t.area(n,i,r)>0}},{key:"intersectsPolygon",value:function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&this.intersects(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}},{key:"locallyInside",value:function(e,r){return area(e.prev,e,e.next)<0?t.area(e,r,e.next)>=0&&t.area(e,e.prev,r)>=0:t.area(e,r,e.prev)<0||t.area(e,e.next,r)<0}},{key:"middleInside",value:function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}},{key:"splitPolygon",value:function(t,e){var r=new u.default(t.i,t.x,t.y),n=new u.default(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}},{key:"insertNode",value:function(t,e,r,n){var i=new u.default(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}},{key:"removeNode",value:function(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}},{key:"signedArea",value:function(t,e,r,n){for(var i=0,a=e,u=r-n;a<r;a+=n)i+=(t[u]-t[a])*(t[a+1]+t[u+1]),u=a;return i}},{key:"deviation",value:function(t,e,r,n){var i=e&&e.length,a=i?e[0]*r:t.length,u=Math.abs(this.signedArea(t,0,a,r));if(i)for(var s=0,o=e.length;s<o;s++){var l=e[s]*r,h=s<o-1?e[s+1]*r:t.length;u-=Math.abs(this.signedArea(t,l,h,r))}var f=0;for(s=0;s<n.length;s+=3){var c=n[s]*r,d=n[s+1]*r,v=n[s+2]*r;f+=Math.abs((t[c]-t[v])*(t[d+1]-t[c+1])-(t[c]-t[d])*(t[v+1]-t[c+1]))}return 0===u&&0===f?0:Math.abs((f-u)/u)}},{key:"flatten",value:function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var u=0;u<e;u++)r.vertices.push(t[i][a][u]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r}}]),t}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.i=e,this.x=r,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=o(r(16)),a=o(r(3)),u=o(r(0)),s=o(r(2));function o(t){return t&&t.__esModule?t:{default:t}}var l=Symbol("WebGL的program"),h=Symbol("转换矩阵变量可用的最大数量"),f=function(){function t(e,r,n,i,a,u){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=e,this.firstTIMEDEBUG=!0,this.DEBUG_DRAW_COUNT=0,this.configured=!1,i=i||0,n=n||e.getParameter(this.gl.MAX_TEXTURE_SIZE);var s=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS);r=r||Math.floor((s-4)/4),r=2,this[h]=r,this.textureManager=null,this.lightPosition=new Float32Array(3),this.lightPosition[0]=e.canvas.clientWidth/2,this.lightPosition[1]=e.canvas.clientHeight/2,this.lightPosition[2]=0,this.init(i,a),this.textureManager.maxHeight=n,this.textureManager.maxWidth=this.textureManager.maxHeight,u=u||!1,this.enableLight(u)}return n(t,[{key:"enableLight",value:function(t){var e=0;e=t?1:0,this.gl.uniform1f(this.shaderInformation.enableLight,e)}},{key:"clean",value:function(){this.DEBUG_DRAW_COUNT=0,this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},{key:"initRending",value:function(){var t=this.gl;t.viewport(0,0,t.canvas.width,t.canvas.height)}},{key:"rendVertexArray",value:function(t,e,r,n,i){this.gl;switch(this.gl.uniform3f(this.shaderInformation.lightPosition,this.lightPosition[0],this.lightPosition[1],this.lightPosition[2]),t){case a.default.ACTION_FILL:this.fillRendVertexArray(e,r,n,i);break;case a.default.ACTION_STROKE:this.strokeRendVertexArray(e,r,n,i)}}},{key:"setUniformTransformMatrix",value:function(t,e){this.gl.uniformMatrix4fv(this.shaderInformation.transformMatrixArray[e],!1,t)}},{key:"configVerticesBufferData",value:function(t,e,r){var n=0,i=0;null==e&&(e=0);for(var a=0;a<t.length;a++)n+=t[a].bufferSize,a==t.length-1&&null!=r?i+=r+1:i+=t[a].vertexNumber;i-=e;var u=this.gl,o=null,l=s.default.getFromCache(n);o=null==l?new Uint8Array(new ArrayBuffer(n)):l.dv instanceof Uint8Array?l.dv:new Uint8Array(l.buffer);var h=null,f=s.default.getFromCache(n/8);h=null==f?new Uint8Array(new ArrayBuffer(n/8)):f.dv instanceof Uint8Array?f.dv:new Uint8Array(f.buffer);for(var c=0,d=0,v=0;v<t.length;v++){var y=t[v],g=new Uint8Array(y.dataBuffer.buffer);o.set(g,c),c+=y.dataBuffer.buffer.byteLength;var b=new Uint8Array(y.matrixIndexBuffer.buffer);h.set(b,d),d+=y.matrixIndexBuffer.buffer.byteLength}var x=this.shaderInformation;return u.bindBuffer(u.ARRAY_BUFFER,x.verticesBuffer),this.prepareVertexDatas(n),u.bufferData(u.ARRAY_BUFFER,o.buffer,u.DYNAMIC_DRAW),s.default.putInCache({buffer:o.buffer,dv:o}),u.bindBuffer(u.ARRAY_BUFFER,this.shaderInformation.matrixIndexBuffer),this.prepareMatrixIndexDatas(n/8),u.bufferData(u.ARRAY_BUFFER,h.buffer,u.DYNAMIC_DRAW),s.default.putInCache({buffer:h.buffer,dv:h}),i}},{key:"fillRendVertexArray",value:function(t,e,r,n){if(null==e&&(e=0),0!=t.length){this.configTexture(n);var i=this.configVerticesBufferData(t,e,r);i<3||(this.gl.drawArrays(this.gl.TRIANGLES,0,i),this.DEBUG_DRAW_COUNT++)}}},{key:"strokeRendVertexArray",value:function(t,e,r){if(null==e&&(e=0),0!=t.length){this.configTexture();var n=this.configVerticesBufferData(t,e,r);n<2||(this.gl.drawArrays(this.gl.LINES,0,n),this.DEBUG_DRAW_COUNT++)}}},{key:"executeRenderAction",value:function(t,e){for(var r=void 0,n=[],i=0;i<t.length;i++){var u=t[i];if(null==r&&(r=u),u.type!=a.default.ACTION_STROKE)u.type==r.type?(u.textureIndex!=r.textureIndex&&-1!=u.textureIndex&&-1!=r.textureIndex&&(this.rendVertexArray(r.type,n,void 0,void 0,r.textureIndex),n=[],r=u),-1==r.textureIndex&&-1!=u.textureIndex&&(r=u),n.push(u.vertexData)):(this.rendVertexArray(r.type,n),i--,r=void 0,n=[]);else{if(u.type==r.type){r=u,n.push(u.vertexData);continue}this.rendVertexArray(r.type,n,void 0,void 0,r.textureIndex),n=[],i--,r=void 0}}0!=n.length&&null!=r&&this.rendVertexArray(r.type,n,0,void 0,r.textureIndex)}},{key:"setLightPosition",value:function(t,e,r){this.lightPosition[0]=t,this.lightPosition[1]=e,this.lightPosition[2]=r}},{key:"configTexture",value:function(t){null==t&&(t=-1);var e=this.gl,r=this.shaderInformation;e.uniform1i(r.textureLocation,0);var n=void 0,i=void 0;-1==t?(n=r.blackTexture,i={width:1,height:1}):(n=this.textureManager.textureArray[t],i=this.textureManager.imageDataArray[t]),e.uniform2f(r.singleCanvas,i.width,i.height),e.activeTexture(e.TEXTURE0+0),e.bindTexture(e.TEXTURE_2D,n)}},{key:"prepareVertexDatas",value:function(t){var e=this.gl,r=this.shaderInformation;e.enableVertexAttribArray(r.vertexAttribute),e.enableVertexAttribArray(r.colorAttribute),e.enableVertexAttribArray(r.textureCoordAttribute);var n=3,i=e.FLOAT,a=0;e.vertexAttribPointer(r.vertexAttribute,n,i,!1,32,a),i=e.UNSIGNED_BYTE,n=4,a=20,e.vertexAttribPointer(r.colorAttribute,n,i,!1,32,a),i=e.FLOAT,n=2,a+=4,e.vertexAttribPointer(r.textureCoordAttribute,n,i,!1,32,a)}},{key:"prepareMatrixIndexDatas",value:function(t){var e=this.gl,r=this.shaderInformation;e.enableVertexAttribArray(r.transformMatrixIndex);var n=e.FLOAT;e.vertexAttribPointer(r.transformMatrixIndex,1,n,!1,4,0)}},{key:"registerTexture",value:function(t){}},{key:"createShaderProgram",value:function(){var t=this.gl,e=this.loadShader(t.VERTEX_SHADER,this.getVertexShaderSource(this.maxTransformMatrixNum)),r=this.loadShader(t.FRAGMENT_SHADER,"\n  precision mediump float;\n  varying vec4 currentColor;\n  varying vec2 v_texcoord;\n  varying vec3 normal;\n  varying vec3 v_position;\n  uniform vec2 singleCanvas;\n  uniform vec3 u_lightPosition;\n  uniform float enableLight;\n  uniform sampler2D u_texture;\n  void main() {\n        vec2 coord = vec2(v_texcoord.x / singleCanvas.x , v_texcoord.y/singleCanvas.y);\n        vec4 color = currentColor;\n        vec3 r_normal = normalize(normal);    \n        vec3 forward = u_lightPosition - v_position;\n        vec3 lightLocation = normalize(forward);    \n        gl_FragColor = color * texture2D(u_texture,coord);\n        if(enableLight == 1.0){\n            gl_FragColor.rgb *= abs(dot(r_normal,lightLocation));\n        }\n  }\n  "),n=t.createProgram();return t.attachShader(n,e),t.attachShader(n,r),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS)?(t.useProgram(n),n):(console.error("无法初始化Program: "+t.getProgramInfoLog(n)),t.deleteProgram(n),null)}},{key:"init",value:function(t,e){var r=this.gl;this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.BLEND),this.gl.disable(this.gl.DEPTH_TEST),this[l]=this.createShaderProgram();var n=this[l];this.shaderInformation=this.initShaderInformation(n),this.textureManager=new i.default(801,801,10,4);var a=void 0;if(0==t)a=u.default.orthoProjection(0,0,r.canvas.width,r.canvas.height,1,Math.abs(2*e));else{var s=Math.atan2(r.canvas.clientHeight/2,Math.abs(e));a=u.default.perspective3(2*s,r.canvas.clientWidth,r.canvas.clientHeight,1,Math.abs(2*e))}r.uniformMatrix4fv(this.shaderInformation.perspectiveMatrix,!1,a)}},{key:"setPerspective",value:function(t,e,r){var n=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,i=u.default.perspective2(0,0,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight,e,r);u.default.perspective(t,n,e,r),i=u.default.perspective3(t,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight,e,r),this.gl.uniformMatrix4fv(this.shaderInformation.perspectiveMatrix,!1,i)}},{key:"initShaderInformation",value:function(t){var e=this.gl,r=e.getAttribLocation(t,"u_texCoord");e.enableVertexAttribArray(r);var n=e.getAttribLocation(t,"a_position");e.enableVertexAttribArray(n);var i=e.getAttribLocation(t,"transform_matrix_index");e.enableVertexAttribArray(i);var a=e.getAttribLocation(t,"color");e.enableVertexAttribArray(a);for(var s=e.getUniformLocation(t,"perspective_matrix"),o=new Array(this.maxTransformMatrixNum),l=0;l<o.length;l++)o[l]=e.getUniformLocation(t,"transform_matrix_array["+l+"]");var h=u.default.identity();e.uniformMatrix4fv(o[0],!1,h);var f=e.getUniformLocation(t,"singleCanvas"),c=e.getUniformLocation(t,"u_lightPosition"),d=e.getUniformLocation(t,"enableLight"),v=e.getUniformLocation(t,"u_texture"),y=e.createBuffer(),g=e.createBuffer(),b=e.createTexture();e.bindTexture(e.TEXTURE_2D,b);var x=new Uint8Array([255,255,255,255]);return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,x),e.bindTexture(e.TEXTURE_2D,null),{vertexAttribute:n,colorAttribute:a,textureCoordAttribute:r,verticesBuffer:y,matrixIndexBuffer:g,perspectiveMatrix:s,transformMatrixArray:o,transformMatrixIndex:i,singleCanvas:f,textureLocation:v,blackTexture:b,lightPosition:c,enableLight:d,webgl:e}}},{key:"loadShader",value:function(t,e){var r=this.gl,n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),r.getShaderParameter(n,r.COMPILE_STATUS)?n:(console.error("着色器编译错误: "+r.getShaderInfoLog(n)),r.deleteShader(n),null)}},{key:"getVertexShaderSource",value:function(t){return" attribute vec4 color;\n     attribute vec4 a_position;\n     attribute vec2 u_texCoord;\n     varying vec3 v_position;\n     attribute float transform_matrix_index;\n     varying vec2 v_texcoord;\n     varying vec4 currentColor;\n     varying vec3 normal;\n     uniform mat4 perspective_matrix;\n     uniform mat4 transform_matrix_array["+t+"];\n     void main() {\n             normal = vec3(0,0,1);\n             vec4 yuandian = vec4(0,0,0,1);\n             v_texcoord = u_texCoord;\n            vec4 new_position = transform_matrix_array[int(transform_matrix_index)] * a_position;\n            v_position = vec3(new_position.xyz);\n            vec4 n_y = transform_matrix_array[int(transform_matrix_index)] * yuandian;\n            vec4 n_n = transform_matrix_array[int(transform_matrix_index)] * vec4(normal,1);\n            normal = vec3(n_n.x-n_y.x,n_n.y-n_y.y,n_n.z-n_y.z);\n            vec4 finalPosition = perspective_matrix* new_position;\n            currentColor = vec4 (color.xyz/255.0,color.w/100.0);\n            gl_Position = finalPosition;\n    }"}},{key:"maxTransformMatrixNum",get:function(){return this[h]}}]),t}();e.default=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a=r(17),u=(n=a)&&n.__esModule?n:{default:n};var s=Symbol("图片缓存"),o=Symbol("texture缓存"),l=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxWidth=e||1,this.maxHeight=r||1,this.maxTextureNum=n||1,this[s]=[],this[o]=[],this.imageDataArray=new Array(this.maxTextureNum),this.textureArray=new Array(this.maxTextureNum),this.singleTexture=void 0,this.lastImageData=void 0,this.space=i||3}return i(t,[{key:"getTexture",value:function(t,e,r){var n=this.imageCatch.indexOf(t);return-1==n?this.registerImageData(t,e,r):this[o][n]}},{key:"registerImageData",value:function(t,e,r){if(null!=t&&null!=t){null==r&&(r=!1);var n=0,i=0,a=t.width,s=t.height;if(a>this.maxWidth||s>this.maxHeight)throw new Error("图片大小超过了最大限制："+this.maxWidth+" x "+this.maxHeight);if(-1==this.imageCatch.indexOf(t)){var l=new u.default,h=l.getContext("2d");h.clearRect(0,0,l.width,l.height);for(var f=-1,c=0;c<this.imageDataArray.length;c++){var d=this.imageDataArray[c];if(null==d)d={imageData:void 0,startX:0,startY:0,width:0,height:0},this.imageDataArray[c]=d,l.width=t.width,l.height=t.height+1,n=0,i=1,h.fillStyle="#ffffff",h.fillRect(0,0,1,1),h.drawImage(t,0,1),d.imageData=h.getImageData(0,0,l.width,l.height),d.startX=l.width+this.space,d.startY=1,d.width=l.width,d.height=l.height;else{var v=t.width,y=t.height;if(n=d.startX,i=d.startY,n+v>this.maxWidth?(n=0,i=d.height+this.space,l.width=Math.max(d.width,v),l.height=i+y,console.log("换行")):(l.width=Math.max(d.width,n+v),l.height=Math.max(d.height,i+y),console.log("不换行")),i+y>this.maxHeight){console.log("图片超过贴图内存最大尺寸");continue}h.putImageData(d.imageData,0,0),h.drawImage(t,n,i),d.imageData=h.getImageData(0,0,l.width,l.height),d.startX=n+v+this.space,d.startY=i,d.width=l.width,d.height=l.height}f=c;break}if(-1!=f){this.imageCatch.push(t);var g={x:n,y:i,width:a,height:s,index:f};return r&&this.createTexture(e,f,l),this[o].push(g),g}}}else console.error("Image can not be null")}},{key:"createAllTexture",value:function(t){if(null!=t)for(var e=new u.default,r=(e.getContext("2d"),0);r<this.textureArray.length;r++)this.createTexture(t,r,e)}},{key:"createTexture",value:function(e,r,n){if(null!=e&&null!=r&&-1!=r){null==n&&(n=new u.default);var i=n.getContext("2d"),a=this.textureArray[r],s=this.imageDataArray[r];null!=s&&(n.width=s.width,n.height=s.height,i.putImageData(s.imageData,0,0),null==a&&(a=e.createTexture(),this.textureArray[r]=a),e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t.isPOT(n.width)&&t.isPOT(n.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null))}}},{key:"imageCatch",get:function(){return this[s]}}],[{key:"isPOT",value:function(t){return t>0&&0==(t-1&t)}}]),t}();e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function t(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),document.createElement("canvas")}}]).default});